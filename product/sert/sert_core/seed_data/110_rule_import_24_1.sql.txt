--liquibase formatted sql
-------------------------------------------------------------------------------
-- Copyright (c) 2024,2025 Oracle and/or its affiliates.
-- Licensed under the Universal Permissive License v 1.0 as shown
-- at https://oss.oracle.com/licenses/upl/
--------------------------------------------------------------------------------
-- This file is supplied for historical purposes only
--
--changeset sert:import_sert_rule_allow-duplicate-submissions-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Allow Duplicate Submissions',
        p_rule_key               => 'ALLOW_DUPLICATE_SUBMISSIONS',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'aeadm/managing-workspace-and-change-requests.html#GUID-782488EB-8DC0-4D04-974E-800E78369BC5',
        p_builder_url_key        => 'PAGE',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGES',
        p_column_to_evaluate     => 'ALLOW_DUPLICATE_SUBMISSIONS',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'No',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and page_id > 0',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Allow Duplicate Page Submissions** attribute determines whether or not a page can be submitted more than once. ',
            '',
            'For example, if this option is enabled, a user can click Submit multiple times, and potentially insert multiple records into the database. Users who use the back button and then try to resubmit a transaction would also be allowed to do so when this attribute is enabled. This would also be the case for a user who accidentally double-clicks a button.',
            '',
            'The recommended setting for this option should be considered on a page-by-page basis, as it will vary based on the function of the page. For pages that insert data into the database or call a procedure, it should be set to `No`. For pages that allow users to filter data, it should be set to `Yes`.',
            '',
            'If this attribute is set to `No`, you can also provide a URL where users will be redirected to, in the case of a duplicate page submission.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To modify the **Allow Duplicate Page Submissions** attribute:',
            '',
            '1.  Edit the page that you want to associate an authorization scheme with.',
            '2.  Edit the page attributes for the page in question by clicking on it''s name in the _Page Rendering_ tree.',
            '3.  In the Advanced section, set the **Enable duplicate page submissions** attribute to the appropriate value, based on the type of page. For example, it should be set to **No** for DML forms and **Yes** for most other types of pages.',
            '4.  If setting it to **No**, then optionally supply a URL to redirect users to in the case of a duplicate page submission.',
            '5.  Click **Save**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Low',
        p_rule_severity_key      => 'LOW',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_application-authorization-scheme-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Application Authorization Scheme',
        p_rule_key               => 'APPLICATION_AUTHORIZATION_SCHEME',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A04-2021',
        p_risk_name              => 'Insecure Design',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-9DFB08E7-0CA4-4C00-B05F-A0678FAAD326',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'AUTHORIZATION_SCHEME',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'IS_NOT_NULL',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'Like most components in APEX, an Application can have an **Authorization Scheme**. By associating the **Authorization Scheme** with the application, only those users who are members of the corresponding **Authorization Scheme** will be able to access the application.',
            '',
            'This technique is critical when using a central Authentication Scheme, such as LDAP. Without an application-level Authorization Scheme, then any user in the LDAP directory will be able to access the application. Thus, it''s a best practice to create a group - either in LDAP or via database tables - and add authorized users to that group. The application Authorization Scheme can then check to see if a user is a member of the associated group or not, thus either allowing them or preventing them from using the application.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            '  To associate an **Authorization Scheme** with an application:',
            '',
            '1.  Edit your application''s **Shared Components**.',
            '2.  In the _Security_ region, click on **Security Attributes**.',
            '3.  In the _Authorization_ region, set the value of _Authorization Scheme_ to the corresponding **Authorization Scheme**.',
            '4.  Click **Apply Changes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'High',
        p_rule_severity_key      => 'HIGH',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_application-computation-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Application Computation SQLi',
        p_rule_key               => 'APPLICATION_COMPUTATION_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'APP_COMPUTATION',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_COMPUTATIONS',
        p_column_to_evaluate     => 'COMPUTATION',
        p_component_id           => 'APPLICATION_COMPUTATION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'COMPUTATION_TYPE:COMPUTATION_ITEM',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Application Computation** definition in question, and edit its **Computation** code in the **Computation** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_application-items-escaped-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Application Items Escaped',
        p_rule_key               => 'APPLICATION_ITEMS_ESCAPED',
        p_category_name          => 'Cross-Site Scripting',
        p_category_key           => 'CROSS_SITE_SCRIPTING',
        p_risk_code              => 'A04-2021',
        p_risk_name              => 'Insecure Design',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-33A67D5E-1128-4D23-9C5C-15FC9BE1B783',
        p_builder_url_key        => 'APP_ITEM',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_ITEMS',
        p_column_to_evaluate     => 'ESCAPE_ON_HTTP_OUTPUT',
        p_component_id           => 'APPLICATION_ITEM_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'ITEM_NAME',
        p_operand                => 'EQUALS',
        p_val_char               => 'Yes',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**Application Items at Risk** are Application Items that have their **Escape Special Characters** attribute set to **No**. ',
            '',
            'When set to **Yes**, any HTML rendered on the page will be properly escaped. When set to **No**, any HTML will be rendered as-is, introducing the risk of malicious code getting executed. ',
            '',
            'Thus, it is recommended to set this **Enable Special Characters** to **Yes**.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To change the **Escape Special Characters** attribute for an **Application Item**:',
            '',
            '1.  Edit your application''s **Shared Components**.',
            '2.  In the Application Logic region, click **Application Items**.',
            '3.  Click the application item you wish to modify.',
            '4.  In the Security region, set the **Escape Special Characters** attribute to  **Yes**',
            '5.  Click **Apply Changes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_application-items-session-state-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Application Items Session State',
        p_rule_key               => 'APPLICATION_ITEMS_SESSION_STATE',
        p_category_name          => 'Cross-Site Scripting',
        p_category_key           => 'CROSS_SITE_SCRIPTING',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-D3ECB171-681E-4452-BB33-5E74EC0EE13E',
        p_builder_url_key        => 'APP_ITEM',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_ITEMS',
        p_column_to_evaluate     => 'SESSION_STATE_PROTECTION',
        p_component_id           => 'APPLICATION_ITEM_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'ITEM_NAME',
        p_operand                => 'DOES_NOT_EQUAL',
        p_val_char               => 'N',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**Application Items at Risk** are Application Items that have their Session State Protection attribute set to **Unrestricted**. ',
            '',
            'These application items can be altered by a malicious user via the URL of a page that does not have session state protection enabled, thus potentially changing application functionality.',
            '',
            'There are two different settings:',
            '',
            '*   **Unrestricted**  ',
            '    Item can be set via the URL or within APEX  ',
            '*   **Restricted - May not be set from browser**  ',
            '    Item can not be set via the URL under any circumstances - even if Session State Protection is disabled at the application level.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To change the **Session State Protection** attribute for an **Application Item**:',
            '',
            '1.  Edit your application''s **Shared Components**.',
            '2.  In the Application Logic region, click **Application Items**.',
            '3.  Click the application item you wish to modify.',
            '4.  In the Security region, set the Session State Protection attribute to any value other than **Unrestricted**.',
            '5.  Click **Apply Changes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_application-process-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Application Process SQLi',
        p_rule_key               => 'APPLICATION_PROCESS_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'APP_PROCESS',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PROCESSES',
        p_column_to_evaluate     => 'PROCESS',
        p_component_id           => 'APPLICATION_PROCESS_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'PROCESS_NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and process is not null',
            'and process_type_code = ''PLSQL''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Application Process** definition in question, and edit its **Code** in the **Source** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_application-rejoin-sessions-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Application Rejoin Sessions',
        p_rule_key               => 'APPLICATION_REJOIN_SESSIONS',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-33A67D5E-1128-4D23-9C5C-15FC9BE1B783',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'REJOIN_EXISTING_SESSIONS',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Disabled',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Rejoin Sessions** attribute will allow users to rejoin a previously established session without providing a Session ID. APEX will only use the existing cookie to determine whether or not to consider the current session as valid.',
            '',
            'Enabling this option does present a security risk, as it would be easier for a hacker to take over an existing APEX session. Thus, this option should be set to Disabled.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Session Management** area, locate **Rejoin Sessions** attribute and change its value to Disabled.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_authorization-scheme-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Authorization Scheme SQLi',
        p_rule_key               => 'AUTHORIZATION_SCHEME_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'AUTHORIZATION',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_AUTHORIZATION',
        p_column_to_evaluate     => 'ATTRIBUTE_01',
        p_component_id           => 'AUTHORIZATION_SCHEME_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'AUTHORIZATION_SCHEME_NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and scheme_type_code in ',
            '  (',
            '   ''NATIVE_EXISTS''',
            '  ,''NATIVE_FUNCTION_BODY''',
            '  ,''NATIVE_NOT_EXISTS''',
            '  )')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Authorization Scheme** definition in question, and edit its **SQL Query** code in the **Authorization Scheme** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_avatar-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Avatar SQLi',
        p_rule_key               => 'AVATAR_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''TMPL_THEME_42$AVATAR''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Avatar Region** in the Page Rendering tree, and edit its **SQL Query** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_avatar-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Avatar WHERE Clause SQLi',
        p_rule_key               => 'AVATAR_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''TMPL_THEME_42$AVATAR''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Avatar Region** in the Page Rendering tree, and edit its **Where Clause** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_badge-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Badge SQLi',
        p_rule_key               => 'BADGE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''TMPL_THEME_42$BADGE''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Badge Region** in the Page Rendering tree, and edit its **SQL Query** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_badge-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Badge WHERE Clause SQLi',
        p_rule_key               => 'BADGE_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''TMPL_THEME_42$BADGE''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Badge Region** in the Page Rendering tree, and edit its **Where Clause** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_branch-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Branch SQLi',
        p_rule_key               => 'BRANCH_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A04-2021',
        p_risk_name              => 'Insecure Design',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'BRANCH',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_BRANCHES',
        p_column_to_evaluate     => 'BRANCH_ACTION',
        p_component_id           => 'BRANCH_ID',
        p_component_name         => 'BRANCH_NAME',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and (branch_language = ''PLSQL'' or branch_type = ''Branch to PL/SQL Procedure'')',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Branch** in the Page Rendering tree **Branches** List, and edit its **PL/SQL Function Body** in the **Behavior** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_breadcrumb-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Breadcrumb AuthZ Inconsistency',
        p_rule_key               => 'BREADCRUMB_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'BREADCRUMB',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with b as',
            '(',
            'select',
            '   be.application_id',
            '  ,b.breadcrumb_name',
            '  ,be.entry_label',
            '  ,be.url',
            '  ,REGEXP_SUBSTR(be.url, ''[^:]+'', 1, 2) as target_page_id',
            '  ,be.authorization_scheme',
            '  ,be.authorization_scheme_id',
            '  ,b.breadcrumb_id',
            '  ,be.breadcrumb_entry_id',
            '  ,(select authorization_scheme',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(be.url, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(be.url, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme',
            '  ,(select authorization_scheme_id',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(be.url, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(be.url, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme_id',
            'from',
            '  apex_application_bc_entries be',
            '  ,apex_application_breadcrumbs b',
            'where',
            '  b.breadcrumb_id = be.breadcrumb_id',
            '  and be.url is not null',
            '  and be.application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,b.application_id as application_id',
            '  ,null as page_id ',
            '  ,breadcrumb_entry_id as component_id ',
            '  ,b.entry_label as component_name',
            '  ,null as column_name ',
            '  ,null as item_name',
            '  ,b.breadcrumb_name as shared_comp_name',
            '  ,''Entry Label: '' || nvl(b.authorization_scheme,''None'') || '' / Page: '' || nvl(b.target_authorization_scheme,''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '  ,case when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '        when nvl(b.target_authorization_scheme_id,0) = nvl(b.authorization_scheme_id,0) then ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' ',
            '    end as result',
            'from b',
            'where 1=1',
            '  and b.application_id = #APP_ID#')),
        p_info                   => '**APEX-SERT** flags **Breadcrumbs** where the Authorization Scheme doesn''t match the Authorization Scheme for the **Page**. This may provide users access to the Page but not the List Entries, or vice versa.',
        p_fix                    => 'Check the **Authorization Schemes** on both the **component** and the **Page** for compatibility. Although they are not _**required**_ to be the same, developers need to make sure that the Authorization Schemes are compatible and will provided the desired result.',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_browser-cache-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Browser Cache',
        p_rule_key               => 'BROWSER_CACHE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html',
        p_builder_url_key        => 'PAGE',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with a as (select browser_cache from apex_applications where application_id = #APP_ID#)',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id',
            '  ,p.application_id as application_id',
            '  ,p.page_id page_id',
            '  ,null as component_id',
            '  ,null as component_name',
            '  ,null as column_name',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,p.browser_cache || '' (page) / '' || a.browser_cache ',
            '     || '' (app)'' as current_value',
            '  ,''Disabled'' as valid_values',
            '  , case when ',
            '      (case when p.browser_cache = ''Application Default'' then a.browser_cache else p.browser_cache end) = ''Disabled'' then ''{ "result":"PASS"}'' else ''{ "result":"FAIL"}'' end as result',
            'from',
            '  apex_application_pages p',
            '  ,a',
            'where',
            '  page_id > 0')),
        p_info                   => apex_string.join(apex_t_varchar2(
            '**Browser Cache** dictates how the user''s browser will store a rendered APEX Page in the browser''s cache. Normally, browsers save the contents of an application''s pages, however if the cache is disabled, the browser will not save the information and will be forced to reload the information from the server.',
            '',
            'From a security standpoint, Browser Cache should be disabled so that no sensitive information will not be kept at the browser level. Setting this to **Disabled** will also help prevent subtle back button issues.',
            '',
            'NOTE: When Browser Cache is set to **DIsabled**, APEX will include the HTTP Header directive cache-control: no-store indicating the browser should not store page content in either memory or disk. This feature will only work with browsers which support the cache-control directive')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To alter the value of **Browser Cache** for a specific page:',
            '',
            '1.  Edit the page attributes for the page in question by clicking on it''s name in the Page Rendering tree.',
            '2.  In the Security region, alter the value for the **Browser Cache** select list.',
            '3.  Click **Save**.Browser Cache has three possible settings:',
            '    1.  **Application Default** - This will take its value from the current application''s Browser Cache attribute.',
            '    2.  **Enabled** - Allows the browser to cache information from the page',
            '    3.  **Disabled** - Prohibits the browser from caching information for the specific page.',
            '',
            'The page level `Browser Cache` setting, other than Application Default, will override what is defined at the Application level.',
            '',
            '**NOTE**: When **Browser Cache** is set to "Disabled", APEX will include the HTTP Header directive  **cache-control: no-store** indicating the browser should not store page content in either memory or disk. This feature will only work with browsers which support the _**cache-control**_ directive.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_build-status-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Build Status',
        p_rule_key               => 'BUILD_STATUS',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-application-attributes.html#GUID-5D88B80F-1A82-474F-A6BC-C7787CC5703F',
        p_builder_url_key        => 'APPLICATION_DEFINITION',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'BUILD_STATUS',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Run Only',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_button-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Button AuthZ Inconsistency',
        p_rule_key               => 'BUTTON_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/providing-security-through-authorization.html#GUID-8FBF5F46-0541-4859-8470-D10E333DD271',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COMPONENT',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with b as',
            '(',
            'select',
            '   application_id',
            '  ,page_id',
            '  ,button_name',
            '  ,region_id',
            '  ,button_id',
            '  ,redirect_url',
            '  ,REGEXP_SUBSTR(redirect_url, ''[^:]+'', 1, 2) as target_page_id',
            '  ,(select authorization_scheme',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(redirect_url, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(redirect_url, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme',
            '  ,(select authorization_scheme_id',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(redirect_url, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(redirect_url, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme_id',
            '  ,authorization_scheme',
            '  ,authorization_scheme_id',
            'from',
            '  apex_application_page_buttons',
            'where',
            '  redirect_url is not null',
            '  and application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,b.application_id as application_id',
            '  ,b.page_id page_id ',
            '  ,b.button_id as component_id ',
            '  ,b.button_name as component_name',
            '  ,null as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,''Button: '' || nvl(authorization_scheme, ''None'') || '' / Page: '' || nvl(target_authorization_scheme, ''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '    ,case when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '        when nvl(target_authorization_scheme_id,0) = nvl(authorization_scheme_id,0) then ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' ',
            '    end as result',
            'from b',
            'where 1=1',
            '  and application_id = #APP_ID#')),
        p_info                   => apex_string.join(apex_t_varchar2(
            'When a **Button** is used to redirect to a **Page** within an application, the **Authorization Scheme** needs to match on both occasions. When the Authorization Scheme of the Page and the Button do not match, it might be possible for the user to have access to the Button and not the Page or vice versa.',
            '',
            'APEX-SERT flags when the Button''s Authorization scheme doesn''t match the Authorization Scheme for the target Page redirection.')),
        p_fix                    => 'Check the **Authorization Schemes** on both the driving **Button** and the target **Page** redirect for compatibility. Although they are not required to be the same, developers need to make sure that the Authorization Schemes are compatible and will provide the desired result.',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_cache-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Cache',
        p_rule_key               => 'CACHE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-8DEEFEE2-0BB6-4882-BC84-8549A6497248',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'BROWSER_CACHE',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Disabled',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**Browser Cache** dictates how the user''s browser will store a rendered APEX Page in the browser''s cache. Normally, browsers save the contents of an application''s pages, however if the cache is disabled, the browser will not save the information and will be forced to reload the information from the server.',
            '',
            'From a security standpoint, **Browser Cache** should be disabled so that no sensitive information will not be kept at the browser level. Setting this to **Disabled** will also help prevent subtle back button issues.',
            '',
            'NOTE: When Browser Cache is set to **Disabled**, APEX will include the HTTP Header directive cache-control: no-store indicating the browser should not store page content in either memory or disk. This feature will only work with browsers which support the cache-control directive')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security** tab.',
            '',
            'In **Browser Security** area, locate **Cache** attribute and change its value to Disabled.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'High',
        p_rule_severity_key      => 'HIGH',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_calendar-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Calendar SQLi',
        p_rule_key               => 'CALENDAR_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''NATIVE_CSS_CALENDAR''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Calendar Region** in the Page Rendering tree, and edit its **SQL Query** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_calendar-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Calendar WHERE Clause SQLi',
        p_rule_key               => 'CALENDAR_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''NATIVE_CSS_CALENDAR''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Calendar Region** in the Page Rendering tree, and edit its **Where Clause** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_cards-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Cards SQLi',
        p_rule_key               => 'CARDS_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''NATIVE_CARDS''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Cards Region** in the Page Rendering tree, and edit its **SQL Query** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_cards-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Cards WHERE Clause SQLi',
        p_rule_key               => 'CARDS_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''NATIVE_CARDS''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Cards Region** in the Page Rendering tree, and edit its **Where Clause** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_card-action-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Card Action AuthZ Inconsistency',
        p_rule_key               => 'CARD_ACTION_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COMPONENT',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with c as',
            '(',
            'select',
            ' ic.application_id',
            ' ,ic.page_id',
            ' ,REGEXP_SUBSTR(ic.link_target, ''[^:]+'', 1, 2) as target_page_id',
            ' ,ic.region_name',
            ' ,ic.region_id',
            ' ,ic.action_id as component_id',
            ' ,nvl(label, action_type) column_alias ',
            ' ,coalesce(ic.authorization_scheme, ',
            '   r.authorization_scheme, ',
            '   pg.authorization_scheme) derived_authorization_scheme',
            ' ,coalesce(ic.authorization_scheme_id, ',
            '   r.authorization_scheme_id, ',
            '   pg.authorization_scheme_id) derived_authorization_scheme_id',
            '  ,(select authorization_scheme',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(ic.link_target, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(ic.link_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '   ) target_authorization_scheme',
            '  ,(select authorization_scheme_id',
            '    from apex_application_pages ',
            '     where to_char(page_id) = REGEXP_SUBSTR(ic.link_target, ''[^:]+'', 1, 2) ',
            '     and REGEXP_LIKE(REGEXP_SUBSTR(ic.link_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '     and application_id = #APP_ID#',
            '   ) target_authorization_scheme_id',
            'from',
            '   apex_appl_page_card_actions ic',
            '  ,apex_application_page_regions r',
            '  ,apex_application_pages pg',
            'where  1=1',
            '  and ic.region_id = r.region_id ',
            '  and ic.link_target is not null',
            '  and pg.page_id = ic.page_id',
            '  and pg.application_id = #APP_ID#',
            '  and ic.application_id = #APP_ID#',
            ')',
            'select #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,c.page_id as page_id ',
            '  ,c.component_id component_id ',
            '  ,c.column_alias as component_name',
            '  ,null as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,''Action: '' || coalesce(c.derived_authorization_scheme,''None'') || '' / Page: '' || nvl(c.target_authorization_scheme,''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            ',case ',
            '  when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '  when nvl(target_authorization_scheme_id,''0'') = coalesce(c.derived_authorization_scheme_id,''0'') then ''{ "reasons":[ ] ,"result":"PASS" }'' ',
            '  else ''{ "reasons":[ ] ,"result":"FAIL" }'' end as result',
            'from c')),
        p_info                   => apex_string.join(apex_t_varchar2(
            'The execution of **Page Processes** can be linked to the click of a specific Button on the same page. When the **Authorization Schemes** of the Process and the Button do not match it might be possible for the user to have access to the Button and not the Process or vice versa.',
            '',
            'APEX-SERT flags Page Processes where the execution is tied to a Button, but where the Button''s Authorization scheme doesn''t match the Authorization Scheme for the Process.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Check the **Authorization Schemes** on both the **Card Action** and the **linked Page**  for compatibility. Although they are not required to be the same, developers need to make sure that the Authorization Schemes are compatible and will provided the desired result.',
            '',
            'When a Card action uses a column substitution for the Action, it cannot be confirmed by APEX-SERT and will require an exception')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_chart-series-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Chart Series SQLi',
        p_rule_key               => 'CHART_SERIES_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'JET_CHART_SERIES',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_CHART_S',
        p_column_to_evaluate     => 'DATA_SOURCE',
        p_component_id           => 'SERIES_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and data_source is not null',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Charts Region Series** in the Page Rendering tree, and edit its **SQL Query** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_chart-series-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Chart Series WHERE Clause SQLi',
        p_rule_key               => 'CHART_SERIES_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_CHART_S',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and where_clause is not null',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Charts Region Series** in the Page Rendering tree, and edit its **Where Clause** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_chart-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Chart SQLi',
        p_rule_key               => 'CHART_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''NATIVE_JET_CHART''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Charts Region** in the Page Rendering tree, and edit its **SQL Query** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_chart-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Chart WHERE Clause SQLi',
        p_rule_key               => 'CHART_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''NATIVE_JET_CHART''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Charts Region** in the Page Rendering tree, and edit its **Where Clause** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_classic-report-column-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Classic Report Column AuthZ Inconsistency',
        p_rule_key               => 'CLASSIC_REPORT_COLUMN_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COLUMN',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with c as',
            '(',
            'select',
            '   ic.application_id',
            '  ,ic.page_id',
            '  ,REGEXP_SUBSTR(ic.column_link_url, ''[^:]+'', 1, 2) as target_page_id',
            '  ,(select authorization_scheme',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(ic.column_link_url, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(ic.column_link_url, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme',
            '  ,(select authorization_scheme_id',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(ic.column_link_url, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(ic.column_link_url, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme_id',
            '  ,ic.region_name',
            '  ,ic.region_id',
            '  ,ic.column_alias',
            '  ,ic.authorization_scheme',
            '  ,ic.authorization_scheme_id',
            'from',
            '   apex_application_page_rpt_cols ic',
            '  ,apex_application_page_regions r',
            'where 1=1',
            '  and ic.region_id = r.region_id ',
            '  and ic.column_link_url is not null',
            '  and ic.application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,c.page_id as page_id ',
            '  ,c.region_id component_id ',
            '  ,null as component_name',
            '  ,c.column_alias as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,''Report Column: '' || nvl(authorization_scheme, ''None'') || '' / Page: '' || nvl(target_authorization_scheme, ''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '  ,case when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '        when nvl(target_authorization_scheme_id,0) = nvl(authorization_scheme_id,0) then ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' ',
            '   end as result',
            'from c',
            'where 1=1',
            '  and application_id = #APP_ID#')),
        p_info                   => '**APEX-SERT** flags **components** where the Authorization Scheme doesn''t match the Authorization Scheme for the **Page**. This may provide users access to the Page but not the List Entries, or vice versa.',
        p_fix                    => 'Check the **Authorization Schemes** on both the **component** and the **Page** for compatibility. Although they are not _**required**_ to be the same, developers need to make sure that the Authorization Schemes are compatible and will provided the desired result.',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_classic-report-column-escaped-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Classic Report Column Escaped',
        p_rule_key               => 'CLASSIC_REPORT_COLUMN_ESCAPED',
        p_category_name          => 'Cross-Site Scripting',
        p_category_key           => 'CROSS_SITE_SCRIPTING',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-33A67D5E-1128-4D23-9C5C-15FC9BE1B783',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COLUMN',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_RPT_COLS',
        p_column_to_evaluate     => 'DISPLAY_AS_CODE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => 'COLUMN_ALIAS',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'DOES_NOT_EQUAL',
        p_val_char               => 'WITHOUT_MODIFICATION',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**Classic Report** columns can render HTML as part of their item. In this case, it is important to ensure that the HTML rendered is properly escaped, so that in the case the HTML contains malicious code, it is rendered harmless.',
            '',
            '**Classic Report** columns contain a property called **Escape Special Characters**. When set to **Yes**, any HTML rendered on the page will be properly escaped. When set to **No**, any HTML will be rendered as-is, introducing the risk of malicious code getting executed. Thus, it is recommended to set this **Enable Special Characters** to **Yes**.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To change the **Escape Special Characters** attribute for a **Classic Report** column:',
            '',
            '1.  Edit the corresponding page of your application that contains the report in question.',
            '2.  Expand the Report in the Rendering panel, click on the Tree View toggle next to the affected report.',
            '3.  Select the column in question.',
            '4.  In the Column Attribute panel/region, locate the **Security section**, and toggle the switch **Escape Special Characters** attribute to **Yes**.',
            '5.  Save your page')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_classic-report-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Classic Report SQLi',
        p_rule_key               => 'CLASSIC_REPORT_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code in (''SQL_QUERY'',''FUNCTION_RETURNING_SQL_QUERY'')',
            'and source_type_plugin_name = ''NATIVE_SQL_REPORT''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Classic Report Region** in the Page Rendering tree, and edit its **SQL Query** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_classic-report-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Classic Report WHERE Clause SQLi',
        p_rule_key               => 'CLASSIC_REPORT_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''SQL_QUERY''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Classic Report Region** in the Page Rendering tree, and edit its **Where Clause** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_cleanup-plsql-code-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Cleanup PL/SQL Code',
        p_rule_key               => 'CLEANUP_PLSQL_CODE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-F2324900-0AD3-4C0A-8B86-AE4B9C25F991',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'DB_SESSION_CLEANUP_CODE',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => 'The **Cleanup PL/SQL Code** is typically used to set the security context of an application. The PL/SQL placed here will execute after everything else on each and every page within your application.',
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Database Session** area, examine **Cleanup PL/SQL Code** attribute for reported SQL Injections issues. In particular, check usage of DBMS\_SQL, EXECUTE\_IMMEDIATE and incorrect item substitution syntax.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_column-toggle-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Column Toggle SQLi',
        p_rule_key               => 'COLUMN_TOGGLE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''NATIVE_JQM_COLUMN_TOGGLE''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Column Toggle Report Region** in the Page Rendering tree, and edit its **SQL Query** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_column-toggle-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Column Toggle WHERE Clause SQLi',
        p_rule_key               => 'COLUMN_TOGGLE_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''NATIVE_JQM_COLUMN_TOGGLE''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Column Toggle Report Region** in the Page Rendering tree, and edit its **Where Clause** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_comments-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Comments SQLi',
        p_rule_key               => 'COMMENTS_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''TMPL_THEME_42$COMMENTS''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_comments-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Comments WHERE Clause SQLi',
        p_rule_key               => 'COMMENTS_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''TMPL_THEME_42$COMMENTS''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_compatibility-mode-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Compatibility Mode',
        p_rule_key               => 'COMPATIBILITY_MODE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A06-2021',
        p_risk_name              => 'Vulnerable and Outdated Components',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/upgrading-apex-applications.html#GUID-3415C581-1146-4D64-8044-DE5BD67F186C',
        p_builder_url_key        => 'APPLICATION_DEFINITION',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'COMPATIBILITY_MODE',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => '21.2',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => 'The **Compatibility Mode** attribute controls the backward compatibility of the APEX runtime engine when executing an application. Certain runtime behaviors change from release to release. To not break or change the behavior of existing applications, this attribute is automatically set during upgrade if necessary.',
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Definition** tab.  ',
            'In **Properties** area, locate **Compatibility Mode** attribute and change its value to the desired setting.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_content-row-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Content Row SQLi',
        p_rule_key               => 'CONTENT_ROW_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''TMPL_THEME_42$CONTENT_ROW''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_content-row-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Content Row WHERE Clause SQLi',
        p_rule_key               => 'CONTENT_ROW_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''TMPL_THEME_42$CONTENT_ROW''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_debug-mode-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Debug Mode',
        p_rule_key               => 'DEBUG_MODE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-application-attributes.html#GUID-583B8D2A-D236-4A35-A510-F87BF3C694FA',
        p_builder_url_key        => 'APPLICATION_DEFINITION',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'DEBUGGING',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Not Allowed',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Debugging** attribute determines whether or not your application can be run in Debug mode. If enabled, then anyone with knowledge of how APEX works - including end users - can run your application with Debug enabled. This will produce a thorough report of your application logic, code and attributes. Although in APEX 4 and above, debug information is no longer emitted to the page, running an application with Debug enables can hinder performance and potentially show components who''s visibility is linked to the Debug setting.',
            '',
            'It is critical that this value be disabled for production applications, as the information provided by debug mode could potentially be used by a hacker to compromise your application.',
            '',
            'This setting should always be set to No, since in APEX 4.2 and above, if you are logged in as a developer and are also running an application, **Debug Mode** will be automatically enabled.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your **Application** Definition, and select **Definition** tab.  ',
            'In Properties area, locate **Debugging** attribute and set its value to **No**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_dynamic-action-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Dynamic Action SQLi',
        p_rule_key               => 'DYNAMIC_ACTION_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'TASK_DEFINITION',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_DA_ACTS',
        p_column_to_evaluate     => 'ATTRIBUTE_01',
        p_component_id           => 'DYNAMIC_ACTION_ID',
        p_component_name         => 'DYNAMIC_ACTION_NAME',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and action_code = ''NATIVE_EXECUTE_PLSQL_CODE''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Dynamic Action** in the Page Rendering tree, and edit its **PL/SQL Code** in the **Settings** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_dynamic-content-contains-binds-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Dynamic Content Contains Binds',
        p_rule_key               => 'DYNAMIC_CONTENT_CONTAINS_BINDS',
        p_category_name          => 'Cross-Site Scripting',
        p_category_key           => 'CROSS_SITE_SCRIPTING',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/cross-site-scripting-protection.html#GUID-3E24746E-378C-478E-85F6-55DD8EC4A367',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id',
            '  ,r.application_id as application_id',
            '  ,r.page_id page_id',
            '  ,r.region_id as component_id',
            '  ,null as component_name',
            '  ,null as column_name',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,r.region_source as current_value',
            '  ,''Returning bind variables should be escaped'' as valid_values',
            '  ,case',
            '    when REGEXP_COUNT(replace(region_source, '':='', null), '':\S*\s'', 1, ''i'') > 0',
            '    then',
            '      ''{ "result":"FAIL"}'' else ''{ "result":"PASS"}''',
            '    end as result',
            'from',
            '  apex_application_page_regions r',
            'where',
            '  page_id > 0',
            '  and source_type_code = ''NATIVE_DYNAMIC_CONTENT''')),
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_dynamic-content-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Dynamic Content SQLi',
        p_rule_key               => 'DYNAMIC_CONTENT_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''NATIVE_DYNAMIC_CONTENT''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_embed-in-frames-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Embed in Frames',
        p_rule_key               => 'EMBED_IN_FRAMES',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-8DEEFEE2-0BB6-4882-BC84-8549A6497248',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'BROWSER_FRAME',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Deny:Allow from same origin',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**Embed in Frames** dictates whether a browser is allowed to display your application pages within an HTML frame, and if so under what circumstances.',
            '',
            'Applications that allow frame embedding are potentially at risk of "clickjacking" atacks. This is where an attacker uses multiple page layers to intercept clicks that were meant for buttons or links in the application, instead routing them to another page.',
            '',
            'Options are:',
            '',
            '*   **Deny** - The page is not allowed to be rendered within a frame, regardless of the site attempting to do so.',
            '*   **Allow** - The page can be displayed in any frame, regardless of origin.',
            '*   **Allow from same origin** - The page can be displayed within a frame, but only if the frame is from the same origin as the page.',
            '',
            'NOTE: This feature requires modern browsers that support the HTTP header response variable _X-Frame-Options_.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your **Application** Definition, and select **Security** tab.  ',
            'In **Browser Security** area, locate **Embed in Frames** attribute and set its value to either **Deny** or **Allow from same origin**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'High',
        p_rule_severity_key      => 'HIGH',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_error-handling-function-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Error Handling Function',
        p_rule_key               => 'ERROR_HANDLING_FUNCTION',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-application-attributes.html#GUID-B744BE26-69B6-4084-A217-114CF05A5A4B',
        p_builder_url_key        => 'APPLICATION_DEFINITION',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'ERROR_HANDLING_FUNCTION',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'IS_NOT_NULL',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The Error Handling Function is a function that will be called when an error is raised from an APEX application. This function can be set to handle specific errors, suppress sensitive information from error messages, and even send notifications when errors occur. This application can be set at the application and page lever, where a page-level setting will override an application-level one.',
            '',
            'While APEX will work just fine without one, it is strongly recommended that a custom function be deployed and deployed with all applications. The Sample Database Application contains a sample error handling function that can be expanded upon.',
            '',
            'The ErrorHandling Functions must adhere to the following signature:',
            '',
            '`function [function name]`   ',
            ' `(`  ',
            '  `p_error in apex_error.t_error`  ',
            ' `)`  ',
            '`return apex_error.t_error_result;`',
            '',
            'See the Oracle APEX API Reference for more details on how to create an Error Handling Function.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Definition** tab.  ',
            'In **Error Handling** area, locate **Error Handling Function** attribute and set its value to not NULL, for example to your PL/SQL error function name.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_facet-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Facet SQLi',
        p_rule_key               => 'FACET_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'WORKFLOW_ACTIVITY',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_PAGE_FILTERS',
        p_column_to_evaluate     => 'LOV_DEFINITION',
        p_component_id           => 'REGION_ID',
        p_component_name         => 'ITEM_NAME',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and suggestions_type_code = ''DYNAMIC''',
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_form-autocomplete-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Form Autocomplete',
        p_rule_key               => 'FORM_AUTOCOMPLETE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/identifying-at-risk-passwords.html#GUID-9B68C8BE-83FD-4057-B098-11ADB6B1411B',
        p_builder_url_key        => 'PAGE',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGES',
        p_column_to_evaluate     => 'FORM_AUTOCOMPLETE',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Off',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and page_id > 0',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'By default, all APEX pages have their **Form Auto Complete** attribute set to enabled. This makes using applications a lot more efficient, as most browsers will remember previous data entered and automatically present those values to users. However, if the data entered is of a sensitive nature - such as credit card, SSN or account numbers - that data will be stored on the client''s local browser.',
            '',
            'While the data stored locallymay be encrypted, it is not password-protected. For example: you enter a credit card number and submit the form. The next time you run that page, the browser will automatically remember which values you previously used. Thus, you will be able to see a list of all previous credit card numbers entered.',
            '',
            '**Form Auto Complete** should only be enabled on pages where there is no concern about the data being entered there. For all other pages, **Form Auto Complete** should be disabled.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To disable **Form Auto Complete**:',
            '',
            '1.  Edit the page attributes for the page in question by clicking on it''s name in the Page Rendering tree.',
            '2.  In the Security region set the value of Form Auto Complete to **Off**.',
            '3.  Click **Save.**')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'High',
        p_rule_severity_key      => 'HIGH',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_hidden-item-value-protected-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Hidden Item Value Protected',
        p_rule_key               => 'HIDDEN_ITEM_VALUE_PROTECTED',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A04-2021',
        p_risk_name              => 'Insecure Design',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/about-item-types.html#GUID-8CAA1BA5-DCA8-4DF0-A841-3DC40E67CA9C',
        p_builder_url_key        => 'PAGE_ITEM',
        p_impact                 => 'ITEM',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_ITEMS',
        p_column_to_evaluate     => 'ATTRIBUTE_01',
        p_component_id           => 'ITEM_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => 'ITEM_NAME',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Y',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and display_as_code = ''NATIVE_HIDDEN''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'Despite its name, a **Hidden Item** will still have its definition and value rendered in the underlying HTML of a page. This allows for a malicious user to both view and edit the value and submit it back to APEX for processing, allowing for the update of unintended records.',
            '',
            'Fortunately, Hidden Items in APEX contain an attribute called Value Protected. When enabled, if the value of a Hidden Item has been manipulated at all, APEX will reject the page submission and generate an error.',
            '',
            'The Value Protected attribute is set to Yes by default, and should be left that way. The only exception to this is when the value of Hidden Item needs to be altered by either JavaScript or a Dynamic Action. If that is the case, and Value Protected is set to No, then additional validations should be made to ensure that the value set was a valid one, not a malicious one.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To ensure that a **Hidden Item** is protected:',
            '',
            '1.  Edit a Hidden page item.',
            '2.  In the Settings region, set the value of Value Protected to **Yes**.',
            '3.  Click **Apply Changes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_html-escaping-mode-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'HTML Escaping Mode',
        p_rule_key               => 'HTML_ESCAPING_MODE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-33A67D5E-1128-4D23-9C5C-15FC9BE1B783',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'HTML_ESCAPING_MODE',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Extended',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'Traditionally, APEX has depended on the htf.escape\_sc function to escape HTML before rendering in certain places. While this approach does work, it is somewhat limited in scope as to what gets escaped, as it will only escape the following characters:',
            '',
            '*   '||chr(38)||'',
            '*   "',
            '*   \<',
            '*   \>',
            '',
            '   ',
            'When set to **Basic**, the **HTML Escaping Mode** will function as if it were calling htf.escape\_sc, and only escape the four characters listed above. Setting it to Extended mode will escape all characters in Basic mode as well as the following characters:',
            '',
            '*   '||chr(38)||'',
            '*   "',
            '*   \<',
            '*   \>',
            '*   ''',
            '*   /',
            '*   Non-ASCII characters',
            '',
            'Additionally, **Extended** mode will also escape non-ASCII characters if the database character set is not set to AL32UTF8. By default, existing applications will have this value set to Basic, and new applications will have it set to Extended. It is recommended to set it to Extended, but only after thorough testing is conducted and functionality is not broken because of the change.',
            '',
            'Note: This feature is only available when the Compatibility Mode attribute is set to 4.1 or greater.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Browser Security** area, locate **HTML Escaping Mode** attribute and set its value to Extended.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'High',
        p_rule_severity_key      => 'HIGH',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_http-response-headers-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'HTTP Response Headers',
        p_rule_key               => 'HTTP_RESPONSE_HEADERS',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-33A67D5E-1128-4D23-9C5C-15FC9BE1B783',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'HTTP_RESPONSE_HEADERS',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'IS_NULL',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => 'The **HTTP Response Headers** attribute allows a developer to supplement what APEX sends to the browser as part of the response header. This is a more advanced feature of APEX, and is unlikely to be used in most applications.',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_include-jquery-migrate-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Include jQuery Migrate',
        p_rule_key               => 'INCLUDE_JQUERY_MIGRATE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A06-2021',
        p_risk_name              => 'Vulnerable and Outdated Components',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-user-interface-attributes.html#GUID-B2B87317-8178-4C82-A4B4-831132EB8A9F',
        p_builder_url_key        => 'APPLICATION_USER_INTERFACE',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_USER_INTERFACES',
        p_column_to_evaluate     => 'INCLUDE_JQUERY_MIGRATE',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'No',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'This setting specifies if the **jQuery Migrate** plug-in should be included on every page in the application.',
            '',
            'The plug-in restores deprecated features and behaviors of jQuery so that old JavaScript code and jQuery plug-ins will still run properly with the jQuery version loaded by Oracle APEX.',
            '',
            'If you are confident your application and any used jQuery plug-in does not contain any references to deprecated jQuery features, set this to **Off** to reduce the overall size of the JavaScript files loaded.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **User Interface tab**.',
            '',
            'In **Javascript** area, locate **Include jQuery Migrate** attribute and use the slider to set its value to **Off**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_include-legacy-javascript-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Include Legacy Javascript',
        p_rule_key               => 'INCLUDE_LEGACY_JAVASCRIPT',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A06-2021',
        p_risk_name              => 'Vulnerable and Outdated Components',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-user-interface-attributes.html#GUID-B2B87317-8178-4C82-A4B4-831132EB8A9F',
        p_builder_url_key        => 'APPLICATION_USER_INTERFACE',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_USER_INTERFACES',
        p_column_to_evaluate     => 'INCLUDE_LEGACY_JAVASCRIPT',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'No',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'This setting specifies if deprecated or desupported **JavaScript** functions are included on every page in the application. ',
            '',
            'The functions deprecated or desupported are listed in the Release Notes for every release. ',
            '',
            'If you are confident your application does not contain any references to those deprecated or desupported functions, **don''t check any checkbox** to reduce the overall size of the JavaScript files loaded.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **User Interface tab**.',
            '',
            'In **Javascript** area, locate **Include Deprecated or Desupported Javascript Functions** attribute and set both Pre 18.1 and 18.x  checkbox values to **Off**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_initialization-plsql-code-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Initialization PL/SQL Code',
        p_rule_key               => 'INITIALIZATION_PLSQL_CODE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-F2324900-0AD3-4C0A-8B86-AE4B9C25F991',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'DB_SESSION_INIT_CODE',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => 'The **Initialization PL/SQL Code** is typically used to set the security context of an application. The PL/SQL placed here will execute before anything else on each and every page within your application.',
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Database Session** area, examine **Initialization PL/SQL Code** attribute for reported SQL Injections issues. In particular, check usage of DBMS\_SQL, EXECUTE\_IMMEDIATE and incorrect item substitution syntax.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-grid-column-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Grid Column AuthZ Inconsistency',
        p_rule_key               => 'INTERACTIVE_GRID_COLUMN_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COLUMN',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with c as',
            '(',
            'select',
            '   ic.application_id',
            '  ,ic.page_id',
            '  ,REGEXP_SUBSTR(ic.link_target, ''[^:]+'', 1, 2) as target_page_id',
            '  ,ic.region_name',
            '  ,ic.region_id',
            '  ,ic.name as column_alias',
            '  ,ic.authorization_scheme',
            '  ,ic.authorization_scheme_id',
            '  ,(select authorization_scheme',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(link_target, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(link_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme',
            '  ,(select authorization_scheme_id',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(link_target, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(link_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme_id',
            'from',
            '   apex_appl_page_ig_columns ic',
            'where 1=1',
            '  and ic.item_type = ''NATIVE_LINK''',
            '  and ic.link_target is not null',
            '  and ic.application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,c.page_id as page_id ',
            '  ,c.region_id component_id ',
            '  ,null as component_name',
            '  ,c.column_alias as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,''IG Column: '' || nvl(authorization_scheme, ''None'') || '' / Page: '' || nvl(target_authorization_scheme, ''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '  ,case ',
            '    when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ',
            '      ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '    when nvl(target_authorization_scheme_id,0) = nvl(authorization_scheme_id,0) then ',
            '      ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' ',
            '   end as result',
            '',
            'from c',
            'where 1=1',
            '  and application_id = #APP_ID#')),
        p_info                   => 'APEX-SERT flags **components** where the Authorization Scheme doesn''t match the Authorization Scheme for the Page. This may provide users access to the Page but not the List Entries, or vice versa.',
        p_fix                    => 'Check the **Authorization Schemes** on both the **component** and the **Page** for compatibility. Although they are not _**required**_ to be the same, developers need to make sure that the Authorization Schemes are compatible and will provided the desired result.',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-grid-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Grid SQLi',
        p_rule_key               => 'INTERACTIVE_GRID_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''NATIVE_IG''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-grid-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Grid WHERE Clause SQLi',
        p_rule_key               => 'INTERACTIVE_GRID_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''NATIVE_IG''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-report-column-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Report Column AuthZ Inconsistency',
        p_rule_key               => 'INTERACTIVE_REPORT_COLUMN_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/providing-security-through-authorization.html#GUID-8FBF5F46-0541-4859-8470-D10E333DD271',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COLUMN',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with c as',
            '(',
            'select',
            '   ic.application_id',
            '  ,ic.page_id',
            '  ,REGEXP_SUBSTR(ic.column_link, ''[^:]+'', 1, 2) as target_page_id',
            '  ,ic.region_name',
            '  ,ic.region_id',
            '  ,ic.column_alias',
            '  ,coalesce( ic.authorization_scheme,r.authorization_scheme) as authorization_scheme',
            '  ,coalesce( ic.authorization_scheme_id, r.authorization_scheme_id) as authorization_scheme_id',
            '  ,(select authorization_scheme',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(ic.column_link, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(ic.column_link, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme',
            '  ,(select authorization_scheme_id',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(ic.column_link, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(ic.column_link, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme_id',
            'from',
            '   apex_application_page_ir_col ic',
            '  ,apex_application_page_regions r',
            'where 1=1',
            '  and ic.region_id = r.region_id ',
            '  and ic.column_link is not null',
            '  and ic.application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,c.page_id as page_id ',
            '  ,c.region_id component_id ',
            '  ,null as component_name',
            '  ,c.column_alias as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,''IR Column: '' || nvl(authorization_scheme, ''None'') || '' / Page: '' || nvl(target_authorization_scheme, ''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '  ,case ',
            '    when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ',
            '      ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '    when nvl(target_authorization_scheme_id,0) = nvl(authorization_scheme_id,0) then ',
            '      ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' ',
            '   end as result',
            'from c',
            'where 1=1',
            '  and application_id = #APP_ID#')),
        p_info                   => '**APEX-SERT** flags **components** where the Authorization Scheme doesn''t match the Authorization Scheme for the **Page**. This may provide users access to the Page but not the List Entries, or vice versa.',
        p_fix                    => 'Check the **Authorization Schemes** on both the **component** and the **Page** for compatibility. Although they are not _**required**_ to be the same, developers need to make sure that the Authorization Schemes are compatible and will provided the desired result.',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-report-column-escaped-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Report Column Escaped',
        p_rule_key               => 'INTERACTIVE_REPORT_COLUMN_ESCAPED',
        p_category_name          => 'Cross-Site Scripting',
        p_category_key           => 'CROSS_SITE_SCRIPTING',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-33A67D5E-1128-4D23-9C5C-15FC9BE1B783',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COLUMN',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_IR_COL',
        p_column_to_evaluate     => 'DISPLAY_TEXT_AS',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => 'COLUMN_ALIAS',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'DOES_NOT_EQUAL',
        p_val_char               => 'WITHOUT_MODIFICATION',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**Interactive Report** columns can render HTML as part of their item. In this case, it is important to ensure that the HTML rendered is properly escaped, so that in the case the HTML contains malicious code, it is rendered harmless.',
            '',
            '**Interactive Report** columns contain a property called **Escape Special Characters**. When set to **Yes**, any HTML rendered on the page will be properly escaped. When set to **No**, any HTML will be rendered as-is, introducing the risk of malicious code getting executed. Thus, it is recommended to set this **Enable Special Characters** to **Yes**.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To change the **Escape Special Characters** attribute for an **Interactive Report** column:',
            '',
            '1.  Edit the corresponding page of your application that contains the report in question.',
            '2.  Expand the Report in the Rendering panel, click on the Tree View toggle next to the affected report.',
            '3.  Select the column in question.',
            '4.  In the Column Attribute panel/region, locate the **Security section**, and toggle the switch **Escape Special Characters** attribute to **Yes**.',
            '5.  Save your page')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-report-link-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Report Link AuthZ Inconsistency',
        p_rule_key               => 'INTERACTIVE_REPORT_LINK_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COLUMN',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with c as',
            '(',
            'select',
            '   application_id',
            '  ,page_id',
            '  ,REGEXP_SUBSTR(detail_link_target, ''[^:]+'', 1, 2) as target_page_id',
            '  ,region_name',
            '  ,region_id',
            '  ,detail_link_auth_scheme as authorization_scheme',
            '  ,detail_link_auth_scheme_id as authorization_scheme_id',
            '  ,(select authorization_scheme',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(detail_link_target, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(detail_link_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme',
            '  ,(select authorization_scheme_id',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(detail_link_target, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(detail_link_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme_id',
            'from',
            '   apex_application_page_ir',
            'where 1=1',
            '  and detail_link_type = ''Custom Link target''',
            '  and application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,c.page_id as page_id ',
            '  ,c.region_id component_id ',
            '  ,null as component_name',
            '  ,null as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,''IR Link: '' || nvl(authorization_scheme, ''None'') || '' / Page: '' || nvl(target_authorization_scheme, ''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '  ,case ',
            '    when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ',
            '      ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '    when nvl(target_authorization_scheme_id,0) = nvl(authorization_scheme_id,0) then ',
            '      ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' ',
            '   end as result',
            '',
            'from c',
            'where 1=1',
            '  and application_id = #APP_ID#')),
        p_info                   => '**APEX-SERT** flags **components** where the Authorization Scheme doesn''t match the Authorization Scheme for the **Page**. This may provide users access to the Page but not the List Entries, or vice versa.',
        p_fix                    => 'Check the **Authorization Schemes** on both the **component** and the **Page** for compatibility. Although they are not _**required**_ to be the same, developers need to make sure that the Authorization Schemes are compatible and will provided the desired result.',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-report-link-text-item-syntax-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Report Link Text '||chr(38)||'ITEM. Syntax',
        p_rule_key               => 'INTERACTIVE_REPORT_LINK_TEXT_ITEM_SYNTAX',
        p_category_name          => 'Cross-Site Scripting',
        p_category_key           => 'CROSS_SITE_SCRIPTING',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/cross-site-scripting-protection.html#GUID-DC111134-6369-4424-8DAD-BB9649F9B03F',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COLUMN',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_IR_COL',
        p_column_to_evaluate     => 'COLUMN_LINKTEXT',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => 'COLUMN_ALIAS',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'XSS_ITEM_SYNTAX',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'Use of **'||chr(38)||'ITEM.** syntax can potentially leave an application open to **SQL Injection** attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the variables will be replaced verbatim with the variable value. For example, suppose there is a a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '**SELECT COUNT(\*) FROM users WHERE username = '''||chr(38)||'USERNAME.'' AND password = '''||chr(38)||'PASSWORD.''**',
            '',
            'If the user were to enter this as their password:',
            '',
            '**i\_dont\_know'' OR ''x'' = ''x**',
            '',
            'The resulting SQL would be:',
            '',
            '**SELECT COUNT(\*) FROM users WHERE username = ''SCOTT'' AND password = ''i\_dont\_know'' OR ''x'' = ''x''**',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.  ',
            'By using bind variables, this can be avoided.',
            '',
            '**SELECT COUNT(\*) FROM users WHERE username = :USERNAME AND password = :PASSWORD**',
            '',
            'Now, if you enter this as your password:',
            '',
            '**i\_dont\_know'' OR ''x'' = ''x**',
            '',
            'Unless that is specifically your password, the database will return _**No Data Found**_.',
            '',
            'While it may not be optimal performance-wise, the following items can safely be used with the **'||chr(38)||'ITEM\_NAME.** syntax, as they are all APEX built-in items and can not be changed by an end-user:',
            '',
            '*   **APP\_ID**',
            '*   **APP\_ALIAS**',
            '*   **APP\_PAGE\_ID**',
            '*   **APP\_USER**',
            '*   **SESSION**',
            '*   **DEBUG**',
            '',
            '**APEX-SERT** will also ignore items that use the '||chr(38)||'ITEM\_NAME. syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To change the **Link Column** attribute for an **Interactive Report** column:',
            '',
            '1.  Edit the corresponding page of your application that contains the report in question.',
            '2.  Expand the Report in the Rendering panel, click on the Tree View toggle next to the affected report.',
            '3.  Select the column in question.',
            '4.  In the Column Attribute panel/region, locate the **Link section**',
            '5.  Ensure that the **'||chr(38)||'ITEM.** reference is to a page item or an application item, and that the value of that item is properly escaped (**Escape Special Characters** attribute to **Yes)**. Otherwise, remove any reference to that item.',
            '6.  Save your page')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-report-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Report SQLi',
        p_rule_key               => 'INTERACTIVE_REPORT_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''DYNAMIC_QUERY''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_interactive-report-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Interactive Report WHERE Clause SQLi',
        p_rule_key               => 'INTERACTIVE_REPORT_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''DYNAMIC_QUERY''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_item-default-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Item Default SQLi',
        p_rule_key               => 'ITEM_DEFAULT_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'PAGE_ITEM',
        p_impact                 => 'ITEM',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_ITEMS',
        p_column_to_evaluate     => 'ITEM_DEFAULT',
        p_component_id           => 'ITEM_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => 'ITEM_NAME',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and item_default is not null',
            'and item_default_type in ',
            '  (',
            '   ''SQL_QUERY''',
            '  ,''SQL_QUERY_COLON''',
            '  ,''EXPRESSION''',
            '  ,''FUNCTION_BODY''',
            '  )')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Page Item** in the Page Rendering tree, and edit its **PL/SQL Function Body** in the **Default** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_item-session-state-protection-level-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Item Session State Protection Level',
        p_rule_key               => 'ITEM_SESSION_STATE_PROTECTION_LEVEL',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A04-2021',
        p_risk_name              => 'Insecure Design',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-D3ECB171-681E-4452-BB33-5E74EC0EE13E',
        p_builder_url_key        => 'PAGE_ITEM',
        p_impact                 => 'ITEM',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_ITEMS',
        p_column_to_evaluate     => 'ITEM_PROTECTION_LEVEL',
        p_component_id           => 'ITEM_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => 'ITEM_NAME',
        p_shared_comp_name       => '',
        p_operand                => 'DOES_NOT_EQUAL',
        p_val_char               => 'Unrestricted',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and display_as_code = ''NATIVE_HIDDEN''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'This attribute identifies the total number ofItems that have their Session State Protection attribute set to Unrestricted for an application. These unrestricteditems can be manipulated via the URL by a malicious user, causing potentially disastrousresults.',
            '',
            'There are four possible values for Session State Protection at the item level:',
            '',
            '*   **Unrestricted**  ',
            '    The item may be set via the URL with no restrictions.',
            '*   **Restricted - may not be set from browser**  ',
            '    The item can not be set via the URL. This value only applies to the following item types:  ',
            '        - Display as Text (escape special characters, does not save state)  ',
            '        - Display as Text (does not save state)  ',
            '        - Display as Text (based on LOV, does not save state)  ',
            '        - Display as Text (based on PLSQL, does not save state)  ',
            '        - Text Field (Disabled, does not save state)  ',
            '        - Stop and Start HTML Table (Displays label only)',
            '*   **Checksum Required - Application Level**  ',
            '    The item can be set via the URL provided an application-level checksum is present in the URL.',
            '*   **Checksum Required - User Level**  ',
            '    The item can be set via the URL provided a user-level checksum is present in the URL.',
            '*   **Checksum Required - Session Level**  ',
            '    The item can be set via the URL provided a session-level checksum is present in the URL.',
            '',
            'It is broken down by page in the summary report. To see which items Session State Protection is set to Unrestricted, click on the View link for the corresponding page.',
            '',
            'Keep in mind that Session State Protection must be enabled at the application level for this attribute to work properly.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To change the **Session State Protection** attribute for a **Page Item**:',
            '',
            '1.  Edit a page item in your application that you wish to enable Session State Protection.',
            '2.  In the Security region, set the Session State Protection attribute to any value other than **Unrestricted**.',
            '3.  Click **Apply Changes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_item-source-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Item Source SQLi',
        p_rule_key               => 'ITEM_SOURCE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'PAGE_ITEM',
        p_impact                 => 'ITEM',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_ITEMS',
        p_column_to_evaluate     => 'ITEM_SOURCE',
        p_component_id           => 'ITEM_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => 'ITEM_NAME',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and item_source is not null',
            'and item_source_type in ',
            '  (',
            '   ''SQL Query (return single value)''',
            '  ,''SQL Query (return colon separated value)''',
            '  ,''Expression''',
            '  ,''Function Body''',
            '  )')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Page Item** in the Page Rendering tree, and edit its **PL/SQL Function Body** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_legacy-region-types-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Legacy Region Types',
        p_rule_key               => 'LEGACY_REGION_TYPES',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-app-legacy-components.html',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'SOURCE_TYPE_CODE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'DOES_NOT_EQUAL',
        p_val_char               => 'CALENDAR:PLSQL_PROCEDURE:DATA_UPLOAD_COLUMN_MAPPING',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => 'Oracle still supports L**egacy** page **region types**, but does not recommend using them.',
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To verify the **Legacy Page Region Type** attribute:',
            '',
            '1.  Edit the corresponding page of your application and navigate to the **region** in question.',
            '2.  In the Identification region, locate the **Type** attribute.',
            '3.  Ensure the **Legacy** region type is not used.',
            '4.  Save your page')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_list-entry-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'List Entry AuthZ Inconsistency',
        p_rule_key               => 'LIST_ENTRY_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'LIST',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with c as',
            '(',
            'select',
            '   le.application_id',
            '  ,null as page_id',
            '  -- substr 5: after the ''f?p=''',
            '  ,REGEXP_SUBSTR(substr(le.entry_target,5), ''[^:]+'', 1, 1) as target_app_id',
            '  ,REGEXP_SUBSTR(le.entry_target, ''[^:]+'', 1, 2) as target_page_id',
            '  ,le.list_name',
            '  ,le.entry_text',
            '  ,le.authorization_scheme',
            '  ,le.authorization_scheme_id',
            '  ,le.list_entry_id',
            '  ,(select app_page.authorization_scheme',
            '      from apex_applications app',
            '      join apex_application_pages app_page on (app.application_id = app_page.application_id)',
            '      where to_char(app_page.page_id) = REGEXP_SUBSTR(le.entry_target, ''[^:]+'', 1, 2) ',
            '      and REGEXP_LIKE(REGEXP_SUBSTR(le.entry_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '      and (to_char(app.application_id) = REGEXP_SUBSTR(substr(le.entry_target,5), ''[^:]+'', 1, 1) or app.alias = REGEXP_SUBSTR(substr(le.entry_target,5), ''[^:]+'', 1, 1) or (REGEXP_SUBSTR(substr(le.entry_target,5), ''[^:]+'', 1, 1) = '''||chr(38)||'APP_ID.'' and to_char(app.application_id) = #APP_ID#)) ',
            '    ) target_authorization_scheme',
            '    ,(select app_page.authorization_scheme_id',
            '      from apex_applications app',
            '      join apex_application_pages app_page on (app.application_id = app_page.application_id)',
            '      where to_char(app_page.page_id) = REGEXP_SUBSTR(le.entry_target, ''[^:]+'', 1, 2) ',
            '      and REGEXP_LIKE(REGEXP_SUBSTR(le.entry_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '      and (to_char(app.application_id) = REGEXP_SUBSTR(substr(le.entry_target,5), ''[^:]+'', 1, 1) or app.alias = REGEXP_SUBSTR(substr(le.entry_target,5), ''[^:]+'', 1, 1) or (REGEXP_SUBSTR(substr(le.entry_target,5), ''[^:]+'', 1, 1) = '''||chr(38)||'APP_ID.'' and to_char(app.application_id) = #APP_ID#)) ',
            '    ) target_authorization_scheme_id',
            'from',
            '   apex_application_list_entries le',
            'where 1=1',
            '  and le.entry_target is not null',
            '  and le.entry_target like ''f?p%''',
            '  and le.application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,null as page_id ',
            '  ,c.list_entry_id component_id ',
            '  ,c.entry_text as component_name',
            '  ,null as column_name ',
            '  ,null as item_name',
            '  ,list_name as shared_comp_name',
            '  ,''List Entry: '' || nvl(c.authorization_scheme,''None'') || '' / Page: '' || nvl(c.target_authorization_scheme,''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '  ,case when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '        when nvl(c.target_authorization_scheme_id,0) = nvl(c.authorization_scheme_id,0) then ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' ',
            '    end as result',
            'from c',
            'where 1=1',
            '  and c.application_id = #APP_ID#')),
        p_info                   => '**APEX-SERT** flags **List Entries** where the Authorization Scheme doesn''t match the Authorization Scheme for the **Page**. This may provide users access to the Page but not the List Entries, or vice versa.',
        p_fix                    => 'Check the **Authorization Schemes** on both the **List Entries** and the **Page** for compatibility. Although they are not _**required**_ to be the same, developers need to make sure that the Authorization Schemes are compatible and will provided the desired result.',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_list-entry-does-not-contain-item-syntax-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'List Entry Does Not Contain '||chr(38)||'ITEM. Syntax',
        p_rule_key               => 'LIST_ENTRY_DOES_NOT_CONTAIN_ITEM_SYNTAX',
        p_category_name          => 'Cross-Site Scripting',
        p_category_key           => 'CROSS_SITE_SCRIPTING',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/creating-lists.html#GUID-0ABE095F-AE4D-438C-840E-3B47915E6109',
        p_builder_url_key        => 'LIST',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_LIST_ENTRIES',
        p_column_to_evaluate     => 'ENTRY_TEXT',
        p_component_id           => 'LIST_ID',
        p_component_name         => 'ENTRY_TEXT',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'LIST_NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'XSS_ITEM_SYNTAX',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'Use of **'||chr(38)||'ITEM.** syntax can potentially leave an application open to **SQL Injection** attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '**SELECT COUNT(\*) FROM users WHERE username = '''||chr(38)||'USERNAME.'' AND password = '''||chr(38)||'PASSWORD.''**',
            '',
            'If the user were to enter this as their password:',
            '',
            '**i\_dont\_know'' OR ''x'' = ''x**',
            '',
            'The resulting SQL would be:',
            '',
            '**SELECT COUNT(\*) FROM users WHERE username = ''SCOTT'' AND password = ''i\_dont\_know'' OR ''x'' = ''x''**',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.  ',
            'By using bind variables, this can be avoided.',
            '',
            '**SELECT COUNT(\*) FROM users WHERE username = :USERNAME AND password = :PASSWORD**',
            '',
            'Now, if you enter this as your password:',
            '',
            '**i\_dont\_know'' OR ''x'' = ''x**',
            '',
            'Unless that is specifically your password, the database will return _**No Data Found**_.',
            '',
            'While it may not be optimal performance-wise, the following items can safely be used with the **'||chr(38)||'ITEM\_NAME.** syntax, as they are all APEX built-in items and can not be changed by an end-user:',
            '',
            '*   **APP\_ID**',
            '*   **APP\_ALIAS**',
            '*   **APP\_PAGE\_ID**',
            '*   **APP\_USER**',
            '*   **SESSION**',
            '*   **DEBUG**',
            '',
            '**APEX-SERT** will also ignore items that use the '||chr(38)||'ITEM\_NAME. syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To change the attributes for a **List Entry**:',
            '',
            '1.  Edit your application''s **Shared Components**.',
            '2.  In the Shared Component region, click your List.',
            '3.  Click the List entry you wish to modify.',
            '4.  Examine each reference using the **'||chr(38)||'ITEM.** syntax. See below for details.',
            '5.  Click **Apply Changes**.',
            '',
            'Examine the code for uses of **'||chr(38)||'ITEM.** syntax and, wherever possible, replace the usage with:',
            '',
            '*   **:ITEM\_NAME** bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   **v(''ITEM\_NAME'')** syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   **ITEM\_NAME** syntax',
            '    *   in conditions',
            '*   **'||chr(38)||'ITEM\_NAME.**',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the **'||chr(38)||'ITEM.** syntax is necessary, developers can mitigate much of the risk by using **HTF.ESCAPE\_SC** to escape the referenced item.',
            '',
            '_**Caution**: Use of **'||chr(38)||'ITEM.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_list-of-values-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'List of Values SQLi',
        p_rule_key               => 'LIST_OF_VALUES_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'LOV',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_LOVS',
        p_column_to_evaluate     => 'LIST_OF_VALUES_QUERY',
        p_component_id           => 'LOV_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'LIST_OF_VALUES_NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and source_type_code in (''FUNC_BODY_RETURNING_SQL'',''SQL'')',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **List of Values** definition in question, and edit its **SQL Query** code in the **Source** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_list-of-values-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'List of Values WHERE Clause SQLi',
        p_rule_key               => 'LIST_OF_VALUES_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'LOV',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_LOVS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'LOV_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'LIST_OF_VALUES_NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and where_clause is not null',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **List of Values** definition in question, and edit its **Where Clause** code in the **Source** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_list-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'List SQLi',
        p_rule_key               => 'LIST_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'LIST',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_LISTS',
        p_column_to_evaluate     => 'LIST_QUERY',
        p_component_id           => 'LIST_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'LIST_NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and list_query is not null',
            'and list_type_code = ''SQL_QUERY''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **List** definition in question, and edit its **Query** in the **List Query** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_logging-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Logging',
        p_rule_key               => 'LOGGING',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-application-attributes.html#GUID-583B8D2A-D236-4A35-A510-F87BF3C694FA',
        p_builder_url_key        => 'APPLICATION_DEFINITION',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'LOGGING',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Yes',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Logging** attribute determines whether or not APEXwill write information to two log tables:',
            '',
            '*   **APEX\_WORKSPACE\_ACCESS\_LOG**  ',
            '    This log records all access attempts - successful or otherwise - made to any APEXapplication. It includes the user name, date of attempt, IPAddress, among other details about each access attempt. When using a custom authentication scheme, you can augment this log with the APEX\_UTIL.SET\_AUTHENTICATION\_RESULT and APEX\_UTIL.SET\_CUSTOM\_AUTH\_STATUS APIs.  ',
            '    undefined',
            '*   **APEX\_WORKSPACE\_ACTIVITY\_LOG**  ',
            '    This log records all page views which occur within your workspace. It includes all pertinent details about each page view, including user name and session, timestamp, IP address, browser, and associated error messages.',
            '',
            'APEX logs are purged roughly every two weeks by default. APEX will retain high-level information from its logs, but this is often times not detailed enough for most organizations. Thus, itis recommended that you configure a custom archival mechanism to preserve all data stored in the logs.')),
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_map-layer-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Map Layer SQLi',
        p_rule_key               => 'MAP_LAYER_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_PAGE_MAP_LAYERS',
        p_column_to_evaluate     => 'LAYER_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and layer_source is not null',
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_map-layer-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Map Layer WHERE Clause SQLi',
        p_rule_key               => 'MAP_LAYER_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_PAGE_MAP_LAYERS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and where_clause is not null',
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_map-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Map SQLi',
        p_rule_key               => 'MAP_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''NATIVE_MAP_REGION''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_map-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Map WHERE Clause SQLi',
        p_rule_key               => 'MAP_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''NATIVE_MAP_REGION''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_maximum-row-count-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Maximum Row Count',
        p_rule_key               => 'MAXIMUM_ROW_COUNT',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A04-2021',
        p_risk_name              => 'Insecure Design',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/developing-reports.html#GUID-A63ECD33-D759-4725-9666-A02719FB35B8',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'select ',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,r.application_id as application_id',
            '  ,r.page_id page_id ',
            '  ,r.region_id as component_id',
            '  ,null as component_name ',
            '  ,null as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,nvl(r.maximum_row_count, 500) as current_value',
            '  ,''Less or Equal to than 500'' as valid_values',
            '  ,case ',
            '     when nvl(r.maximum_row_count, 500) < 501 then ''{"result":"PASS"}'' ',
            '     else ''{"result":"FAIL"}'' ',
            '     end as result ',
            'from',
            '  apex_application_page_rpt rpt',
            ' ,apex_application_page_regions r ',
            'where ',
            '  rpt.region_id = r.region_id')),
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Maximum Row Count** of a report dictates the maximum number of rows that will be retrieved from the database. A high Maximum Row Count could allow a user to access and export large amounts of data and walk away with it.',
            '',
            'During normal system use, most users will be working with the first few hundred rows of data in a report and will never navigate past the first few pages. It is an advantage, not only for security but also for performance reasons to keep the **Maximum Row Count** as low as possible.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To set the **Maximum Row Count**:  ',
            '**Classic Reports**',
            '',
            '1.  Select the Attributes node of the corresponding Classic Report.',
            '2.  In the Advanced region, set `Maximum Row Count` to the desired value.',
            '3.  Click **Save**.',
            '',
            '---',
            '',
            '**Interactive Reports:**',
            '',
            '1.  Select the Attributes node of the corresponding Interactive Report.',
            '2.  In the Advanced region, set the value of `Maximum Row Count` to the desired value.',
            '3.  Click **Save**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_maximum-session-idle-time-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Maximum Session Idle Time',
        p_rule_key               => 'MAXIMUM_SESSION_IDLE_TIME',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-33A67D5E-1128-4D23-9C5C-15FC9BE1B783',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'MAXIMUM_SESSION_IDLE_SECONDS',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'LESS_THAN',
        p_val_char               => '',
        p_val_number             => 3601,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Maximum Session Idle** attribute determines how long - in seconds, not minutes - an APEX session can be idle before it is automatically timed out.',
            '',
            'If this value is set to NULL, then APEX will not check for idle time, thus enabling a user to be idle for as long as the Maximum Session Length permits.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Session Management** area, locate **Maximum Session Idle Time in Seconds** attribute and change its value to between 0 and 3600.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_maximum-session-length-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Maximum Session Length',
        p_rule_key               => 'MAXIMUM_SESSION_LENGTH',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-33A67D5E-1128-4D23-9C5C-15FC9BE1B783',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'MAXIMUM_SESSION_LIFE_SECONDS',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'LESS_THAN',
        p_val_char               => '',
        p_val_number             => 28801,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Maximum Session Length** attribute determines how long - in seconds, not minutes - an APEX session will be valid before it is automatically timed out.',
            '',
            'If this value is set to NULL, then the session will be good indefinitely. However, by default, all APEX sessions older than 8 hours are purged every 24 hours. Thus, unless the frequency of this job is changed, the longest APEX session possible is closer to 8 hours.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Session Management** area, locate **Maximum Session Length in Seconds** attribute and change its value to between 0 and 28800.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_max-rows-to-query-classic-report-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Max Rows to Query - Classic Report',
        p_rule_key               => 'MAX_ROWS_TO_QUERY_CLASSIC_REPORT',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-classic-reports.html#GUID-6C9E3F69-691B-4501-8020-097C92508561',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'MAXIMUM_ROWS_TO_QUERY',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'LESS_THAN',
        p_val_char               => '',
        p_val_number             => 1000,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and source_type_code = ''SQL_QUERY''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Max Rows to Query** is the Classic Report **Number of Rows** attribute that represents a number of rows to display per **report page**. It is the pagination page size. ',
            '',
            'For performance reasons keep the **Max Rows to Query** value below 1000.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To set the **Max Rows to Query** in a Classic Report:',
            '',
            '1.  Edit the corresponding page of your application and navigate to the Classic Report in question.',
            '2.  Select the Attributes node of the report.',
            '3.  In the Layout region, set **Number of Rows** to the value less than 1000.',
            '4.  Click **Save**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_media-list-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Media List SQLi',
        p_rule_key               => 'MEDIA_LIST_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''TMPL_THEME_42$MEDIA_LIST''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_media-list-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Media List WHERE Clause SQLi',
        p_rule_key               => 'MEDIA_LIST_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''TMPL_THEME_42$MEDIA_LIST''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_on-demand-application-process-with-no-authz-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'On Demand Application Process with No AuthZ',
        p_rule_key               => 'ON_DEMAND_APPLICATION_PROCESS_WITH_NO_AUTHZ',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'APP_PROCESS',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PROCESSES',
        p_column_to_evaluate     => 'AUTHORIZATION_SCHEME',
        p_component_id           => 'APPLICATION_PROCESS_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'PROCESS_NAME',
        p_operand                => 'IS_NOT_NULL',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and process_point = ''On Load: Before Header (page template header)''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'Like most components in APEX, an On demand Application Process can have an **Authorization Scheme**.  By associating the **Authorization Scheme** with the On demand Application Process, only those users who are members of the corresponding **Authorization Scheme** will be able to run the process.',
            '',
            'This technique is critical when using a central **Authentication Scheme**, such as LDAP. Without an application-level **Authorization Scheme**, any user in the LDAP directory will be able to run the process. Thus, it''s a best practice to create a group - either in LDAP or via database tables - and add authorized users to that group. The application **Authorization Scheme** can then check to see if a user is a member of the associated group or not, thus either allowing them or preventing them from running the process.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To associate an **Authorization Scheme** with an On Demand Application Process:',
            '',
            '1.  Edit your On Demand Application Process in **Shared Components**.',
            '2.  In the Authorization region, set the value of Authorization Scheme to any appropriate value except for **No Authorization Required**.',
            '3.  Click **Apply Changes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_on-demand-page-process-with-no-authz-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'On Demand Page Process with No AuthZ',
        p_rule_key               => 'ON_DEMAND_PAGE_PROCESS_WITH_NO_AUTHZ',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'PAGE_PROCESS',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_PROC',
        p_column_to_evaluate     => 'AUTHORIZATION_SCHEME',
        p_component_id           => 'PROCESS_ID',
        p_component_name         => 'PROCESS_NAME',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'IS_NOT_NULL',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and process_point_code = ''ON_DEMAND''',
        p_custom_query           => '',
        p_info                   => 'Like most components in APEX, an On demand Page Process can have an **Authorization Scheme**.  By associating the **Authorization Scheme** with the On demand Page Process, only those users who are members of the corresponding **Authorization Scheme** will be able to execute the process.',
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To associate an **Authorization Scheme** with an On Demand Page Process:',
            '',
            '1.  Edit the page and locate the **On Demand Page Process** in question. ',
            '2.  Click on the process name in the _Page Rendering_ tree.',
            '3.  In the **Security** Region, set the **Authorization Scheme** attribute to any appropriate non NULL value.',
            '4.  Click **Save**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_page-access-protection-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Page Access Protection',
        p_rule_key               => 'PAGE_ACCESS_PROTECTION',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A04-2021',
        p_risk_name              => 'Insecure Design',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/preventing-url-tampering.html#GUID-C47B5B4C-FA49-47C7-BAAE-6D5A06DE029C',
        p_builder_url_key        => 'PAGE',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGES',
        p_column_to_evaluate     => 'PAGE_ACCESS_PROTECTION',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Arguments Must Have Checksum:No URL Access:No Arguments Allowed',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and page_id > 0',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'Each page in an APEX application has an attribute called **Page Access Protection**. This attribute determines how a page can be accessed, and whether or not you can pass item values to the page.',
            '',
            'There are four modes for **Page Access Protection**:',
            '',
            '*   **Unrestricted**  ',
            '    This page can be accessed via the URL and all URL parameters (request, session state, item values) are allowed',
            '*   **Arguments Must Have Checksum**',
            '*   URL parameters ( request, session state, item values)can only be passed to this page if a corresponding checksum is also present in the URL. Individual items must also be protected at either the session, user or application level.',
            '*   **No Arguments Supported**  ',
            '    URL parameters (request, session state, item values) for this page are prohibited, but the page can still be accessed via entering its corresponding URL.',
            '*   **No URL Access**  ',
            '    Not only are URL parameters (request, session state, item values) prohibited, but the only way to access this page is the result of an APEX branch.',
            '',
            'By default, all APEX pages are created with this attribute set to Unrestricted. That means that users can pass values to any of the URL parameters on any APEX page unless you take time to change this attribute.',
            '',
            'If you elect to use Arguments Must Have Checksum, then enabling this attribute is only part one of a two step process. You should take care to enable the corresponding attribute for each item that you wish to protect on this page.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To modify the **Page Access Protection** attribute:',
            '',
            '1.  Edit the page attributes for the page in question by clicking on it''s name in the _Page Rendering_ tree.',
            '2.  In the Security Region, set the **Page Access Protection** attribute to anything except **Unrestricted**.',
            '3.  Click **Save**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_page-authorization-scheme-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Page Authorization Scheme',
        p_rule_key               => 'PAGE_AUTHORIZATION_SCHEME',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A01-2021',
        p_risk_name              => 'Broken Access Control',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/providing-security-through-authorization.html#GUID-8FBF5F46-0541-4859-8470-D10E333DD271',
        p_builder_url_key        => 'PAGE',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGES',
        p_column_to_evaluate     => 'AUTHORIZATION_SCHEME',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'IS_NOT_NULL',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and page_id > 0 ',
            'and page_template <> ''Login''')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'Setting an **Authorization Scheme** at the page level is just as critical as setting one at the application level. Page-level authorization schemes restrict which authenticated users can see which pages. Quite often, applications will contain more than one role, and need to be secured so that users from one role can not see pages associated with other roles. Thus, each page should be associated with an **Authorization Scheme**, thus securing the page and all of its associated content.',
            '',
            'Often, developers will only associate the authorization scheme with a tab, link or button. This will only hide the corresponding table, link or button; it will do nothing to stop a malicious user from changing the URL to view potentially sensitive pages that they are not supposed to see.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To associate an **Authorization Scheme** with a page:',
            '',
            '1.  Edit the page attributes for the page in question by clicking on it''s name in the Page Rendering tree.',
            '2.  In the Security region, set the value of **Authorization Scheme** to the corresponding Authorization Scheme that you want to associate with this page.',
            '3.  Click **Save**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_page-caching-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Page Caching',
        p_rule_key               => 'PAGE_CACHING',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-page-attributes-in-page-designer.html#GUID-5CF0B715-7A6B-4A49-B14B-471CCA2C775C',
        p_builder_url_key        => 'PAGE',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGES',
        p_column_to_evaluate     => 'CACHED',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'No',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and page_id > 0',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**Page Caching**  ',
            'Select how the Oracle APEX engine can **cache** HTML text on the server side. If caching can be used, it emits the cached result instead of computing it again. This cuts down on expensive computation time on the server. This feature is unrelated to the browser''s caching capabilities.',
            '',
            'Available options include:  ',
            'Disabled - Content is not cached and computed for each request.  ',
            'Enabled - Content is cached and utilized by all users.  ',
            'Cache By User - Content is cached specifically for each user.  ',
            'Cache By Session - Content is cached specifically for each session.',
            '',
            'From a security standpoint, **Page Caching** should be **Disabled** so that page specific sensitive information will not be kept at the browser level. It will also ensure that information displayed is up to date.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To modify the **Page Caching** attribute:',
            '',
            '1.  Edit the page attributes for the page in question by clicking on it''s name in the _Page Rendering_ tree.',
            '2.  In the **Server Cache** Region, set the **Caching** attribute to **Disabled**.',
            '3.  Click **Save**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_page-computation-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Page Computation SQLi',
        p_rule_key               => 'PAGE_COMPUTATION_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'PAGE_COMPUTATION',
        p_impact                 => 'ITEM',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => 'ITEM_NAME',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,c.page_id page_id ',
            '  ,c.computation_id as component_id ',
            '  ,null as component_name',
            '  ,null as column_name ',
            '  ,c.item_name || '' / '' || c.computation_type as item_name',
            '  ,null as shared_comp_name',
            '  ,c.computation as current_value',
            '  ,''Criteria '' as valid_values',
            '  ,eval_pkg.eval_criteria(p_column_to_evaluate => COMPUTATION, p_rule_criteria_type_key => ''SQLI'', p_application_id => #APP_ID#) as result ',
            'from',
            '   apex_application_page_comp c',
            '  ,apex_application_page_items i',
            ' ,apex_application_page_regions r ',
            'where 1=1 ',
            '  and c.application_id = #APP_ID# ',
            '  and c.computation_type in (''SQL Query (return single value)'',''SQL Query (return colon separated value)'',''Expression'',''Function Body'')',
            '  and c.item_name = i.item_name',
            '  and c.application_id = i.application_id',
            '  and i.region_id = r.region_id(+)')),
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Page Computation** in the Page Rendering tree, and edit its **PL/SQL Function Body** in the **Computation** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_page-item-encryption-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Page Item Encryption',
        p_rule_key               => 'PAGE_ITEM_ENCRYPTION',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A02-2021',
        p_risk_name              => 'Cryptographic Failures',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-page-items.html#GUID-C89752E5-6CAD-49DF-9ED7-6DDAFC491F95',
        p_builder_url_key        => 'PAGE_ITEM',
        p_impact                 => 'ITEM',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_ITEMS',
        p_column_to_evaluate     => 'ENCRYPT_SESSION_STATE',
        p_component_id           => 'ITEM_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => 'ITEM_NAME',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Yes',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'AND DISPLAY_AS_CODE not in (''NATIVE_IMAGE_UPLOAD'',''NATIVE_FILE'')',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'When users fill out a form in APEX, the data that is sent back to the server is stored unencrypted in the APEX session table - WWV\_FLOW\_DATA. While there are adequate precautions taken to ensure that other users can not see this data, there is nothing to stop an APEX workspace administrator or DBA from seeing it.',
            '',
            'Thus, you should consider applying **Item Level Encryption** to any item that could contain sensitive data. With this feature enabled, the values of items in APEX session state are encrypted before they are stored, preventing APEX workspace administrator and even DBAs from snooping. ',
            '',
            'Enabling this feature requires no additional changes to your APEX applications. You can still refer to encrypted items the same way you would refer to unencrypted ones. APEX will automatically encrypt and decrypt them for you.',
            '',
            'Note: Application Items do not currently support this feature. Thus, if you need to store data in an encrypted fashion, you should use Page 0 items instead.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To enable **item-level encryption**:',
            '',
            '1.  Edit a page item in your application that you wish to enable item-level encryption.',
            '2.  In the Security region, set the value of **Store value encrypted in session state** to **Yes**.',
            '3.  Click **Apply Changes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_page-process-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Page Process SQLi',
        p_rule_key               => 'PAGE_PROCESS_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'PAGE_PROCESS',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_PROC',
        p_column_to_evaluate     => 'PROCESS_SOURCE',
        p_component_id           => 'PROCESS_ID',
        p_component_name         => 'PROCESS_NAME:PROCESS_POINT',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and process_type_code = ''PLSQL''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Page Process** in the Page Rendering tree, and edit its **PL/SQL Code** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_page-requires-authentication-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Page Requires Authentication',
        p_rule_key               => 'PAGE_REQUIRES_AUTHENTICATION',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/establishing-user-identity-through-authentication.html#GUID-45C4B1CD-4231-4FE9-8B5B-C90611F5F57B',
        p_builder_url_key        => 'PAGE',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGES',
        p_column_to_evaluate     => 'PAGE_REQUIRES_AUTHENTICATION',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Yes',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and page_id > 0',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Authentication** page attribute determines whether a user needs to be authenticated or not in order to see the page. No specific membership or Authorization Scheme is required.',
            '',
            'If you need some pages to be public - in that anyone will be able to view them - you can set this attribute to Page is Public. Otherwise, all pages in your application should have this set to Page Requires Authentication.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To change the Authentication page-level attribute:',
            '',
            '1.  Edit the page attributes for the page in question by clicking on it''s name in the Page Rendering tree.',
            '2.  In the Security region, set the value of Authentication to **Page Requires Authentication**.',
            '3.  Click **Save**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_process-button-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Process Button AuthZ Inconsistency',
        p_rule_key               => 'PROCESS_BUTTON_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COMPONENT',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with c as',
            '(',
            'select',
            '   application_id',
            '  ,button_name',
            '  ,button_id',
            '  ,authorization_scheme',
            '  ,authorization_scheme_id',
            'from',
            '   apex_application_page_buttons',
            'where 1=1',
            '  and authorization_scheme_id is not null',
            '  and application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,page_id as page_id ',
            '  ,p.process_id component_id ',
            '  ,c.button_name || '' => '' || p.process_name as component_name',
            '  ,null as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,''Button: '' || nvl(c.authorization_scheme,''None'') || '' / Process: '' || nvl(p.authorization_scheme,''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '  ,case when nvl(p.authorization_scheme_id,0) = nvl(c.authorization_scheme_id,0) then ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' end as result',
            'from',
            '   apex_application_page_proc p',
            '  ,c',
            'where 1=1',
            '  and p.application_id = #APP_ID#',
            '  and p.when_button_pressed_id = c.button_id')),
        p_info                   => apex_string.join(apex_t_varchar2(
            'The execution of a **Page Processes** can be linked to the click of a specific **Button** on the same page. When the **Authorization Schemes** of the Process and the Button do not match it might be possible for the user to have access to the Button and not the Process or vice versa.',
            '',
            '**APEX-SERT** flags **Page Processes** where the execution is tied to a Button, but where the Button''s Authorization scheme doesn''t match the Authorization Scheme for the Process.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Check the Authorization Schemes on both the driving Button and the Page Process for compatibility. ',
            '',
            'Although they are not _required_ to be the same, developers need to make sure that the Authorization Schemes are compatible and will provide the desired result.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_referrer-policy-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Referrer Policy',
        p_rule_key               => 'REFERRER_POLICY',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-5AEB6EEF-A89B-41B6-B8D5-00A0FD926E8F',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'REFERRER_POLICY',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'strict-origin',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'This attribute defines what Oracle APEX sends in the **Referrer-Policy** HTTP response header. Referrer-Policy controls what the browser sends to servers in the **Referer** and **Origin** request headers, when users click on links or submit pages. ',
            '',
            'Normally, this information includes the full URL, including Oracle APEX session IDs, which should not be exposed to third parties. New applications should use the value **strict-origin**, unless there are specific business requirements for a different setting.',
            '',
            'Please see the [documentation for the Referrer-Policy header and its available values](https://www.w3.org/TR/referrer-policy/) for further information.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Browser Security** area, locate **Referrer Policy** attribute and change its value to **strict-origin**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_reflow-report-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Reflow Report SQLi',
        p_rule_key               => 'REFLOW_REPORT_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code = ''NATIVE_JQM_REFLOW''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_reflow-report-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Reflow Report WHERE Clause SQLi',
        p_rule_key               => 'REFLOW_REPORT_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''NATIVE_JQM_REFLOW''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_rejoin-sessions-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Rejoin Sessions',
        p_rule_key               => 'REJOIN_SESSIONS',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A01-2021',
        p_risk_name              => 'Broken Access Control',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/editing-page-attributes-in-page-designer.html#GUID-C5DC542A-6963-43AB-AA35-26FDC0730B18',
        p_builder_url_key        => 'PAGE',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGES',
        p_column_to_evaluate     => 'REJOIN_EXISTING_SESSIONS',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Disabled',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'and page_id > 0',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Rejoin Sessions** attribute will allow users to rejoin a previously established session without providing a Session ID. APEX will only use the existing cookie to determine whether or not to consider the current session as valid.',
            '',
            'Enabling this option does present a security risk, albeint a minimum one.  A hacker would still need to be able to gain access to and replicate an APEX session cookie to hijack a session. Ideally, if not needed, this option should be set to **Disabled**.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'To alter the value of **Rejoin Sessions** for a specific page:',
            '',
            '1.  Edit the page attributes for the page in question by clicking on it''s name in the Page Rendering tree.',
            '2.  In the Security region, set the value for Rejoin Sessions to **Disabled**. Alternatively, if the Application Level setting is set to **Disabled**, then set it to **Application Default**.',
            '3.  Click **Save**.Rejoin Sessions has four possible settings at the page level:',
            '    1.  **Application Default** - This will take its value from the current application''s Rejoin Sessions attribute.',
            '    2.  **Disabled** - Sessions cannot be rejoined at all',
            '    3.  **Enabled for Public Sessions** - APEX will attempt to rejoin an existing session only when navigating to a page that is publicly accessible.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Low',
        p_rule_severity_key      => 'LOW',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_runtime-api-usage-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Runtime API Usage',
        p_rule_key               => 'RUNTIME_API_USAGE',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A04-2021',
        p_risk_name              => 'Insecure Design',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-F2324900-0AD3-4C0A-8B86-AE4B9C25F991',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'RUNTIME_API_USAGE',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'IS_NULL',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'This attribute controls how this application can access Oracle APEX APIs that modify applications and workspace data, while it is running.',
            '',
            '*   Modify This Application: The application can modify itself.',
            '*   Modify Other Applications: The application can change other applications in the workspace.',
            '*   Modify Workspace Repository: The application can change workspace users and groups.',
            '',
            'Unless there is a specific requirement, It is recommended to have all three options set to **No**.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Advanced** area, locate **Runtime API Usage** attribute and change all 3 options to **No**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_run-authorization-on-background-jobs-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Run Authorization on Background Jobs',
        p_rule_key               => 'RUN_AUTHORIZATION_ON_BACKGROUND_JOBS',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-69485470-823B-4CC0-9E11-1CF144054F53',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'AUTHORIZE_BATCH_JOB',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Yes',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'This attribute defines whether the authorization schemes at application, page, region and column level are checked in the background job such as interactive report subscriptions. Options include:',
            '',
            '*   **On** - If you select **On**, the authorization is checked.',
            '*   **Off** - If you select **Off**, the authorization is ignored.',
            '',
            'Note: The background job authorization check uses cloned session state instead of the current session state. The cloned session state does NOT include collection, report settings nor session state set during the post authentication process. The authorization check may fail if session state in cloned session is not found.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Authorization** area, locate **Run on Background Job** attribute and change its value to **Yes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_run-authorization-on-public-pages-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Run Authorization on Public Pages',
        p_rule_key               => 'RUN_AUTHORIZATION_ON_PUBLIC_PAGES',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-69485470-823B-4CC0-9E11-1CF144054F53',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'AUTHORIZE_PUBLIC_PAGES',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Yes',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => 'AND AUTHORIZATION_SCHEME_ID <> ''MUST_NOT_BE_PUBLIC_USER''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'If a page is set to a Public Page, it is likely that the developer intended that page to always be available to anyone - regardless whether they are authenticated or not. However, if there is an Authorization Scheme associated with the application itself, it is possible that pages that intended to be public will not render, based on the result of the Authorization Scheme.',
            '',
            'If this is the case, set **Run Authorization on Public Pages** to **No** so that pages that are set to public will bypass the application-level Authorization Scheme when rendering. If the Authorization Scheme still needs to be checked - even on public pages - then set set **Run Authorization on Public Pages** to **Yes**. Thus, the correct value of this attribute is largely dependent on the intended behavior of public pages, and is largely subjective.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Authorization** area, locate **Run on Public Pages** attribute and change its value to **Yes**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_session-state-protection-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Session State Protection',
        p_rule_key               => 'SESSION_STATE_PROTECTION',
        p_category_name          => 'Misconfiguration',
        p_category_key           => 'MISCONFIGURATION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/configuring-security-attributes.html#GUID-D3ECB171-681E-4452-BB33-5E74EC0EE13E',
        p_builder_url_key        => 'APPLICATION_SECURITY_ATTRIBUTES',
        p_impact                 => 'APP',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATIONS',
        p_column_to_evaluate     => 'SESSION_STATE_PROTECTION',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'EQUALS',
        p_val_char               => 'Enabled',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            'The **Session State Protection** attribute determines whether or not your application will provide support for the Session State Protection feature. Enabling it does not actually provide any protection. Each page and individual item must be configured for Session State Protection to work.',
            '',
            'It is essential that **Session State Protection** be enabled and then configured in your application to prevent multiple types of attack.')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to your Application Definition, and select **Security tab**.',
            '',
            'In **Session State Protection** area, locate **Session State Protection** attribute and set its value to **Enabled**.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'High',
        p_rule_severity_key      => 'HIGH',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_task-definition-actions-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Task Definition Actions SQLi',
        p_rule_key               => 'TASK_DEFINITION_ACTIONS_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'TASK_DEFINITION',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_TASKDEF_ACTIONS',
        p_column_to_evaluate     => 'ACTION_CLOB',
        p_component_id           => 'TASK_DEF_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'TASK_DEF_NAME:NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and action_clob_language = ''PLSQL'' and action_type_code = ''NATIVE_PLSQL''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Task** definition in question, select corresponding **Action**, and edit its **Code** in the **Code** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_task-definition-actions-sql-query-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Task Definition Actions SQL Query SQLi',
        p_rule_key               => 'TASK_DEFINITION_ACTIONS_SQL_QUERY_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'TASK_DEFINITION',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_TASKDEFS',
        p_column_to_evaluate     => 'ACTIONS_SQL_QUERY',
        p_component_id           => 'TASK_DEF_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and actions_sql_query is not null',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Task** definition in question, and edit its **Actions SQL Query** code in the **Settings** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_task-definition-due-on-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Task Definition Due On SQLi',
        p_rule_key               => 'TASK_DEFINITION_DUE_ON_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'TASK_DEFINITION',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_TASKDEFS',
        p_column_to_evaluate     => 'DUE_ON_INTERVAL',
        p_component_id           => 'TASK_DEF_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and due_on_type_code in (''SQL_QUERY'',''FUNCTION_BODY'',''EXPRESSION'')',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Task** definition in question, and edit its **Due On** code in the **Deadline** region.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_task-definition-parameter-value-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Task Definition Parameter Value SQLi',
        p_rule_key               => 'TASK_DEFINITION_PARAMETER_VALUE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'TASK_DEFINITION',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_TASKDEF_COMP_PARAMS',
        p_column_to_evaluate     => 'VALUE',
        p_component_id           => 'COMPONENT_PARAMETER_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'COMPONENT_NAME:PARAM_NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and value_type_code in (''SQL_QUERY'',''FUNCTION_BODY'',''EXPRESSION'')',
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_task-definition-participants-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Task Definition Participants SQLi',
        p_rule_key               => 'TASK_DEFINITION_PARTICIPANTS_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_TASKDEF_PARTICIPANTS',
        p_column_to_evaluate     => 'VALUE',
        p_component_id           => 'TASK_DEF_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'TASK_DEF_ID:TASK_DEF_NAME:PARTICIPANT_TYPE:VALUE_TYPE',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and value_type_code in (''SQL_QUERY'',''FUNCTION_BODY'',''EXPRESSION'')',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Task** definition in question, select corresponding **Participant** in the Participants region, and edit its **Value**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_theme-component-action-authz-inconsistency-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Theme Component Action AuthZ Inconsistency',
        p_rule_key               => 'THEME_COMPONENT_ACTION_AUTHZ_INCONSISTENCY',
        p_category_name          => 'Access Control',
        p_category_key           => 'ACCESS_CONTROL',
        p_risk_code              => 'A05-2021',
        p_risk_name              => 'Security Misconfiguration',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/attaching-an-authorization-scheme.html#GUID-84B6EB45-768F-4BA7-A20A-6A7EA3513A50',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'COMPONENT',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'CUSTOM_QUERY',
        p_view_name              => '',
        p_column_to_evaluate     => '',
        p_component_id           => '',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => '',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => '',
        p_additional_where       => '',
        p_custom_query           => apex_string.join(apex_t_varchar2(
            'with c as',
            '(',
            'select',
            '   ic.application_id',
            '  ,ic.page_id',
            '  ,REGEXP_SUBSTR(ic.link_target, ''[^:]+'', 1, 2) as target_page_id',
            '  ,ic.region_name',
            '  ,ic.region_id',
            '  ,nvl(label, position_name) || '' ('' || ic.display_sequence || '')'' as column_alias',
            '  ,coalesce( ic.authorization_scheme, r.authorization_scheme) as authorization_scheme',
            '  ,coalesce( ic.authorization_scheme_id, r.authorization_scheme_id) as authorization_scheme_id',
            '  ,(select authorization_scheme',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(link_target, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(link_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme',
            '  ,(select authorization_scheme_id',
            '    from apex_application_pages ',
            '    where to_char(page_id) = REGEXP_SUBSTR(link_target, ''[^:]+'', 1, 2) ',
            '    and REGEXP_LIKE(REGEXP_SUBSTR(link_target, ''[^:]+'', 1, 2), ''^[[:digit:]]+$'') ',
            '    and application_id = #APP_ID#',
            '  ) target_authorization_scheme_id',
            'from',
            '   apex_appl_page_comp_actions ic',
            '  ,apex_application_page_regions r',
            'where 1=1',
            '  and ic.region_id = r.region_id ',
            '  and ic.link_target is not null',
            '  and ic.application_id = #APP_ID#',
            ')',
            'select',
            '   #EVAL_ID# as eval_id',
            '  ,#RULE_ID# as rule_id ',
            '  ,c.application_id as application_id',
            '  ,c.page_id as page_id ',
            '  ,c.region_id component_id ',
            '  ,c.column_alias as component_name',
            '  ,null as column_name ',
            '  ,null as item_name',
            '  ,null as shared_comp_name',
            '  ,''Action: '' || nvl(authorization_scheme, ''None'') || '' / Page: '' || nvl(target_authorization_scheme, ''None'') as current_value',
            '  ,''AuthZ Schemes Match'' as valid_values',
            '  ,case ',
            '    when NOT regexp_like(target_page_id, ''^[[:digit:]]+$'') then ',
            '      ''{ "reasons":[ {"reason":"target page is not a literal"} ] ,"result":"FAIL" }''',
            '    when nvl(target_authorization_scheme_id,0) = nvl(authorization_scheme_id,0) then ',
            '      ''{ "reasons":[ ] ,"result":"PASS" }'' else ''{ "reasons":[ ] ,"result":"FAIL" }'' ',
            '   end as result',
            'from c',
            'where 1=1',
            '  and c.application_id = #APP_ID#')),
        p_info                   => '**APEX-SERT** flags **components** where the Authorization Scheme doesn''t match the Authorization Scheme for the **Page**. This may provide users access to the Page but not the List Entries, or vice versa',
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Check the **Authorization Schemes** on both the **component** and the **Page** for compatibility. Although they are not _**required**_ to be the same, developers need to make sure that the Authorization Schemes are compatible and will provided the desired result.',
            '',
            'When an theme component action uses a column substitution for the Action, it cannot be confirmed by APEX-SERT and will require an exception')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_timeline-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Timeline SQLi',
        p_rule_key               => 'TIMELINE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'REGION_SOURCE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and region_source is not null',
            'and source_type_code in ''TMPL_THEME_42$TIMELINE''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_timeline-where-clause-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Timeline WHERE Clause SQLi',
        p_rule_key               => 'TIMELINE_WHERE_CLAUSE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'REGION',
        p_impact                 => 'REGION',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_REGIONS',
        p_column_to_evaluate     => 'WHERE_CLAUSE',
        p_component_id           => 'REGION_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and where_clause is not null',
            'and source_type_code = ''TMPL_THEME_42$TIMELINE''')),
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_validation-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Validation SQLi',
        p_rule_key               => 'VALIDATION_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'VALIDATION',
        p_impact                 => 'PAGE',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPLICATION_PAGE_VAL',
        p_column_to_evaluate     => 'VALIDATION_EXPRESSION1',
        p_component_id           => 'VALIDATION_ID',
        p_component_name         => 'VALIDATION_NAME',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => '',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => apex_string.join(apex_t_varchar2(
            'and validation_type_code in ',
            '  (',
            '   ''EXPRESSION''',
            '  ,''PLSQL_ERROR''',
            '  ,''FUNC_BODY_RETURNING_BOOLEAN''',
            '  ,''FUNC_BODY_RETURNING_ERR_TEXT''',
            '  )')),
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Page** definition in question, select corresponding **Validation** in the Page Rendering tree, and edit its **PL/SQL Code raising Error** in the **Validation** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_workflow-activities-additional-data-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Workflow Activities Additional Data SQLi',
        p_rule_key               => 'WORKFLOW_ACTIVITIES_ADDITIONAL_DATA_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'WORKFLOW_ACTIVITY',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_WORKFLOW_ACTIVITIES',
        p_column_to_evaluate     => 'QUERY_SOURCE',
        p_component_id           => 'ACTIVITY_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'WORKFLOW_NAME:WORKFLOW_VERSION:NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and query_source is not null',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Workflow** definition in question, select corresponding **Activity** in the Workflow Rendering tree **Activities** List, and edit its **SQL Query** code in the **Additional Data** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_workflow-activitiy-source-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Workflow Activity Source SQLi',
        p_rule_key               => 'WORKFLOW_ACTIVITIY_SOURCE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'WORKFLOW_ACTIVITY',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_WORKFLOW_ACTIVITIES',
        p_column_to_evaluate     => 'ACTIVITY_CODE',
        p_component_id           => 'ACTIVITY_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'WORKFLOW_NAME:WORKFLOW_VERSION:NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and activity_type_code = ''NATIVE_PLSQL'' and activity_code_language = ''PLSQL''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Workflow** definition in question, select corresponding **Activity** in the Workflow Rendering tree **Activities** List, and edit its **PL/SQL Code** in the **Source** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_workflow-activity-email-attachment-sql-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Workflow Activity Email Attachment SQL SQLi',
        p_rule_key               => 'WORKFLOW_ACTIVITY_EMAIL_ATTACHMENT_SQL_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'WORKFLOW_ACTIVITY',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_WORKFLOW_ACTIVITIES',
        p_column_to_evaluate     => 'ATTRIBUTE_09',
        p_component_id           => 'ACTIVITY_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'WORKFLOW_NAME:WORKFLOW_VERSION:NAME',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and activity_type_code = ''NATIVE_SEND_EMAIL''',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Workflow** definition in question, select corresponding **Activity** of type **Send E-Mail** in the Workflow Rendering tree **Activities** List, and edit its **Attachment SQL** in the **Settings** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_workflow-activity-variable-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Workflow Activity Variable SQLi',
        p_rule_key               => 'WORKFLOW_ACTIVITY_VARIABLE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'WORKFLOW_ACTIVITY_VARIABLE',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_WORKFLOW_ACT_VARS',
        p_column_to_evaluate     => 'VALUE',
        p_component_id           => 'VARIABLE_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'WORKFLOW_NAME:WORKFLOW_VERSION:LABEL',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and value_type_code in (''SQL_QUERY'',''FUNCTION_BODY'',''EXPRESSION'')',
        p_custom_query           => '',
        p_info                   => apex_string.join(apex_t_varchar2(
            '**DBMS\_SQL**',
            '',
            'The improper use of DBMS\_SQL could introduce the potential for a SQL Injection attack - specifically if the SQL to be executed contains evaluated APEX items - even with the bind variable syntax.',
            '',
            '**EXECUTE IMMEDIATE**',
            '',
            'While not specifically a risk in itself, the use of EXECUTE IMMEDIATE is considered a risk as it can perform virtually any type of action within the parse as schema. Any use of EXECUTE IMMEDIATE should be treated with _extreme caution\*\*.\*\*_',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Use of  '||chr(38)||'ITEM.  syntax can potentially leave an application open to SQL Injection attacks. Developers must take extreme care to insure that any use of this syntax is controlled in such a way that the SQL Injection risk is minimized.',
            '',
            'This is especially true when '||chr(38)||'ITEM. Syntax is used as part of a SQL statement as the veriables will be replaced verbatim with the variable value. For example, suppose there is a form online that allows a user to sign on with a username and password which ultimately executes this query:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = '''||chr(38)||'USERNAME.'' ',
            'AND password = '''||chr(38)||'PASSWORD.''',
            '```',
            '',
            'If the user were to enter this as their password:',
            '',
            '`i_dont_know'' OR ''x'' = ''x`',
            '',
            'The resulting SQL would be:',
            '',
            '```sql',
            'SELECT COUNT(*) ',
            'FROM users ',
            'WHERE username = ''SCOTT'' ',
            'AND password = ''i_dont_know'' OR ''x'' = ''x''',
            '```',
            '',
            'This will erroneously return 1 rather than No Data Found and allow the user to log in.    ',
            'By using bind variables, this can be avoided.',
            '',
            'APEX-SERT will also ignore items that use the `'||chr(38)||'ITEM_NAME.` syntax if they are:',
            '',
            '*   Properly secured Application Items',
            '*   Properly secured Page Items',
            '*   Application Substitution Strings')),
        p_fix                    => apex_string.join(apex_t_varchar2(
            'Navigate to the **Workflow** definition in question, select corresponding **Variable** in the Workflow Rendering tree **Activity Variables** List, and edit its **SQL Query** in the **Value** region. Click **Save**.',
            '',
            '**'||chr(38)||'ITEM. syntax**',
            '',
            'Examine the code for uses of '||chr(38)||'ITEM. syntax and, wherever possible, replace the usage with:',
            '',
            '*   `:ITEM_NAME` bind variable syntax',
            '    *   in SQL Statements',
            '    *   in anonymous PL/SQL blocks in APEX',
            '*   `v(''ITEM_NAME'')` syntax',
            '    *   in stored PL/SQL program units called from APEX',
            '*   `ITEM_NAME` syntax',
            '    *   in conditions',
            '*   `'||chr(38)||'ITEM_NAME.`',
            '    *   Templates, Regions, Tabs, Menus, Lists',
            '',
            'When use of the `'||chr(38)||'ITEM.` syntax is necessary, developers can mitigate much of the risk by using `HTF.ESCAPE_SC` to escape the referenced item.',
            '',
            '_**Caution**: Use of_ `_**'||chr(38)||'ITEM**_`_**.** syntax in certain circumstances may also provide the opportunity for a Cross Site Scripting risk. See the XSS Section of APEX-SERT for details._',
            '',
            '---',
            '',
            '**DBMS\_SQL** ',
            '',
            'Verify that any use of `DBMS_SQL` is not evaluating APEX items before executing them.',
            '',
            'When you are forced to use `'||chr(38)||'ITEM.` notation, always be aware of the source of those items and whether or not they have been properly escaped using the `HTF.ESCAPE_SC` function.',
            '',
            'Beware of the improper use of Bind Variables in Dynamic SQL. For Instance:',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno ='' || :P1_EMPNO;',
            'RETURN l_sql;',
            '```',
            '',
            'is no better than using `'||chr(38)||'ITEM.` syntax, as the value of the bind variable will be concatenated verbatim to the query string. Instead, be sure to embed the bind variables in the string, so that when the query executes, they appear as bind variables, not evaluated values.',
            '',
            '```sql',
            'l_sql := ''SELECT * FROM emp',
            'WHERE empno = :P1_EMPNO'';',
            'RETURN l_sql;',
            '```',
            '',
            '---',
            '',
            '**Execute Immediate**',
            '',
            'Either avoid use of `EXECUTE IMMEDIATE`, or do everything possible to endure that the code that is being executed can not be maliciously influenced by the input of end users. Developers should pay special attention to any use of `EXECUTE IMMEDIATE` that uses values from the APEX Session State as they may be able to be directly or indirectly influenced by end users.')),
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_workflow-participants-value-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Workflow Participants Value SQLi',
        p_rule_key               => 'WORKFLOW_PARTICIPANTS_VALUE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'WORKFLOW_PARTICIPANT',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_WORKFLOW_PARTICIPANT',
        p_column_to_evaluate     => 'VALUE',
        p_component_id           => 'PARTICIPANT_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'WORKFLOW_NAME:WORKFLOW_VERSION:PARTICIPANT_TYPE',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and value_type_code in (''SQL_QUERY'',''FUNCTION_BODY'',''EXPRESSION'')',
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_workflow-variables-value-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Workflow Variables Value SQLi',
        p_rule_key               => 'WORKFLOW_VARIABLES_VALUE_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'WORKFLOW_VARIABLE',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_WORKFLOW_VARIABLES',
        p_column_to_evaluate     => 'VALUE',
        p_component_id           => 'VARIABLE_ID',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'WORKFLOW_NAME:WORKFLOW_VERSION:LABEL',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and value is not null',
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required

--changeset sert:import_sert_rule_workflow-version-additional-data-sqli-24-1 stripComments:false endDelimiter:/ runOnChange:true
begin
    sert_core.data_api.import_rule(
        p_rule_name              => 'Workflow Version Additional Data SQLi',
        p_rule_key               => 'WORKFLOW_VERSION_ADDITIONAL_DATA_SQLI',
        p_category_name          => 'SQL Injection',
        p_category_key           => 'SQL_INJECTION',
        p_risk_code              => 'A03-2021',
        p_risk_name              => 'Injection',
        p_apex_version           => 24.1,
        p_help_url               => 'htmdb/managing-application-security.html#GUID-417EAE67-7A36-4AE0-816B-D28716829F96',
        p_builder_url_key        => 'WORKFLOW_VERSION',
        p_impact                 => 'SC',
        p_active_yn              => 'Y',
        p_internal_yn            => 'N',
        p_rule_type              => 'APEX_VIEW',
        p_view_name              => 'APEX_APPL_WORKFLOW_VERSIONS',
        p_column_to_evaluate     => 'QUERY_SOURCE',
        p_component_id           => 'WORKFLOW_VERSION',
        p_component_name         => '',
        p_column_name            => '',
        p_item_name              => '',
        p_shared_comp_name       => 'WORKFLOW_NAME:WORKFLOW_VERSION',
        p_operand                => 'CRITERIA',
        p_val_char               => '',
        p_val_number             => null,
        p_case_sensitive_yn      => 'N',
        p_rule_criteria_type_key => 'SQLI',
        p_additional_where       => 'and query_type_code = ''SQL''',
        p_custom_query           => '',
        p_info                   => '',
        p_fix                    => '',
        p_time_to_fix            => null,
        p_rule_severity_name     => 'Medium',
        p_rule_severity_key      => 'MEDIUM',
        p_description            => '' );
end;
/
--rollback not required